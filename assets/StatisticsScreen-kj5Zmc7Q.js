import{c as w,u as B,g as H,j as n,C as S}from"./index-BL24ehDD.js";import{n as Y,d as L,t as h,c as F,a as I,b as M,s as _,C as z,T as A}from"./differenceInCalendarDays-DlAfXj1i.js";const R=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],W=w("clock",R);const $=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],E=w("trending-up",$);function Z(t,e,s){const[a,i]=Y(s?.in,t,e),c=C(a,i),m=Math.abs(L(a,i));a.setDate(a.getDate()-c*m);const u=+(C(a,i)===-c),d=c*(m-u);return d===0?0:d}function C(t,e){const s=t.getFullYear()-e.getFullYear()||t.getMonth()-e.getMonth()||t.getDate()-e.getDate()||t.getHours()-e.getHours()||t.getMinutes()-e.getMinutes()||t.getSeconds()-e.getSeconds()||t.getMilliseconds()-e.getMilliseconds();return s<0?-1:s>0?1:s}function J(t,e){const s=h(t,e?.in);return s.setDate(1),s.setHours(0,0,0,0),s}function q(t,e){return h(t,e?.in).getDay()}function G(t,e){return h(t,e?.in).getHours()}function x(t,e){const s=()=>F(e?.in,NaN),i=X(t);let c;if(i.date){const l=tt(i.date,2);c=et(l.restDateString,l.year)}if(!c||isNaN(+c))return s();const m=+c;let u=0,d;if(i.time&&(u=st(i.time),isNaN(u)))return s();if(i.timezone){if(d=nt(i.timezone),isNaN(d))return s()}else{const l=new Date(m+u),g=h(0,e?.in);return g.setFullYear(l.getUTCFullYear(),l.getUTCMonth(),l.getUTCDate()),g.setHours(l.getUTCHours(),l.getUTCMinutes(),l.getUTCSeconds(),l.getUTCMilliseconds()),g}return h(m+u+d,e?.in)}const v={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},K=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,Q=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,V=/^([+-])(\d{2})(?::?(\d{2}))?$/;function X(t){const e={},s=t.split(v.dateTimeDelimiter);let a;if(s.length>2)return e;if(/:/.test(s[0])?a=s[0]:(e.date=s[0],a=s[1],v.timeZoneDelimiter.test(e.date)&&(e.date=t.split(v.timeZoneDelimiter)[0],a=t.substr(e.date.length,t.length))),a){const i=v.timezone.exec(a);i?(e.time=a.replace(i[1],""),e.timezone=i[1]):e.time=a}return e}function tt(t,e){const s=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+e)+"})|(\\d{2}|[+-]\\d{"+(2+e)+"})$)"),a=t.match(s);if(!a)return{year:NaN,restDateString:""};const i=a[1]?parseInt(a[1]):null,c=a[2]?parseInt(a[2]):null;return{year:c===null?i:c*100,restDateString:t.slice((a[1]||a[2]).length)}}function et(t,e){if(e===null)return new Date(NaN);const s=t.match(K);if(!s)return new Date(NaN);const a=!!s[4],i=f(s[1]),c=f(s[2])-1,m=f(s[3]),u=f(s[4]),d=f(s[5])-1;if(a)return ct(e,u,d)?at(e,u,d):new Date(NaN);{const l=new Date(0);return!rt(e,c,m)||!ot(e,i)?new Date(NaN):(l.setUTCFullYear(e,c,Math.max(i,m)),l)}}function f(t){return t?parseInt(t):1}function st(t){const e=t.match(Q);if(!e)return NaN;const s=D(e[1]),a=D(e[2]),i=D(e[3]);return lt(s,a,i)?s*I+a*M+i*1e3:NaN}function D(t){return t&&parseFloat(t.replace(",","."))||0}function nt(t){if(t==="Z")return 0;const e=t.match(V);if(!e)return 0;const s=e[1]==="+"?-1:1,a=parseInt(e[2]),i=e[3]&&parseInt(e[3])||0;return dt(a,i)?s*(a*I+i*M):NaN}function at(t,e,s){const a=new Date(0);a.setUTCFullYear(t,0,4);const i=a.getUTCDay()||7,c=(e-1)*7+s+1-i;return a.setUTCDate(a.getUTCDate()+c),a}const it=[31,null,31,30,31,30,31,31,30,31,30,31];function P(t){return t%400===0||t%4===0&&t%100!==0}function rt(t,e,s){return e>=0&&e<=11&&s>=1&&s<=(it[e]||(P(t)?29:28))}function ot(t,e){return e>=1&&e<=(P(t)?366:365)}function ct(t,e,s){return e>=1&&e<=53&&s>=0&&s<=6}function lt(t,e,s){return t===24?e===0&&s===0:s>=0&&s<60&&e>=0&&e<60&&t>=0&&t<25}function dt(t,e){return e>=0&&e<=59}const ut=t=>{if(t.length===0)return{totalPoems:0,poemsThisWeek:0,poemsThisMonth:0,averageLength:0,mostUsedTags:[],writingStreak:0,mostProductiveDay:"Brak danych",mostProductiveHour:0};const e=new Date,s=_(e,{weekStartsOn:1}),a=J(e),i=t.filter(r=>x(r.date)>=s).length,c=t.filter(r=>x(r.date)>=a).length,m=t.reduce((r,o)=>r+o.content.length,0),u=Math.round(m/t.length),d={};t.forEach(r=>{r.tags.forEach(o=>{d[o]=(d[o]||0)+1})});const l=Object.entries(d).map(([r,o])=>({tag:r,count:o})).sort((r,o)=>o.count-r.count).slice(0,5),g=t.map(r=>r.date.split("T")[0]).filter((r,o,y)=>y.indexOf(r)===o).sort().reverse();let N=0;const U=e.toISOString().split("T")[0];if(g.length>0){let r=new Date(U);for(const o of g){const y=new Date(o),k=Z(r,y);if(k===0||k===1)N++,r=y;else break}}const j={};t.forEach(r=>{const o=q(x(r.date));j[o]=(j[o]||0)+1});const T=Object.entries(j).sort((r,o)=>o[1]-r[1])[0]?.[0],b=T?["Niedziela","Poniedziałek","Wtorek","Środa","Czwartek","Piątek","Sobota"][parseInt(T)]:"Brak danych",p={};t.forEach(r=>{const o=G(x(r.createdAt||r.date));p[o]=(p[o]||0)+1});const O=Object.entries(p).sort((r,o)=>o[1]-r[1])[0]?.[0]?parseInt(Object.entries(p).sort((r,o)=>o[1]-r[1])[0][0]):0;return{totalPoems:t.length,poemsThisWeek:i,poemsThisMonth:c,averageLength:u,mostUsedTags:l,writingStreak:N,mostProductiveDay:b,mostProductiveHour:O}},ht=()=>{const{t}=B(),e=H(),s=ut(e);return n.jsxs("div",{children:[n.jsxs("header",{className:"mb-xl",children:[n.jsx("h1",{style:{fontSize:"2rem",marginBottom:"0.5rem",fontWeight:300},children:t.statistics.title}),n.jsx("p",{className:"text-secondary",children:t.statistics.subtitle})]}),n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(150px, 1fr))",gap:"var(--spacing-md)",marginBottom:"var(--spacing-xl)"},children:[n.jsxs("div",{className:"card",style:{textAlign:"center",cursor:"default"},children:[n.jsx(S,{size:32,style:{margin:"0 auto var(--spacing-sm)",opacity:.6}}),n.jsx("p",{style:{fontSize:"2rem",fontWeight:300,marginBottom:"var(--spacing-xs)"},children:s.totalPoems}),n.jsx("p",{className:"text-secondary",style:{fontSize:"0.875rem"},children:t.statistics.totalPoems})]}),n.jsxs("div",{className:"card",style:{textAlign:"center",cursor:"default"},children:[n.jsx(E,{size:32,style:{margin:"0 auto var(--spacing-sm)",opacity:.6}}),n.jsx("p",{style:{fontSize:"2rem",fontWeight:300,marginBottom:"var(--spacing-xs)"},children:s.writingStreak}),n.jsx("p",{className:"text-secondary",style:{fontSize:"0.875rem"},children:t.statistics.currentStreak})]}),n.jsxs("div",{className:"card",style:{textAlign:"center",cursor:"default"},children:[n.jsx(z,{size:32,style:{margin:"0 auto var(--spacing-sm)",opacity:.6}}),n.jsx("p",{style:{fontSize:"2rem",fontWeight:300,marginBottom:"var(--spacing-xs)"},children:s.poemsThisWeek}),n.jsx("p",{className:"text-secondary",style:{fontSize:"0.875rem"},children:t.statistics.averagePerWeek})]}),n.jsxs("div",{className:"card",style:{textAlign:"center",cursor:"default"},children:[n.jsx(W,{size:32,style:{margin:"0 auto var(--spacing-sm)",opacity:.6}}),n.jsx("p",{style:{fontSize:"2rem",fontWeight:300,marginBottom:"var(--spacing-xs)"},children:s.poemsThisMonth}),n.jsx("p",{className:"text-secondary",style:{fontSize:"0.875rem"},children:t.statistics.mostProductiveDay})]})]}),n.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"var(--spacing-lg)"},children:[n.jsxs("div",{className:"card",style:{cursor:"default"},children:[n.jsxs("h3",{style:{marginBottom:"var(--spacing-md)",fontWeight:500,display:"flex",alignItems:"center",gap:"var(--spacing-sm)"},children:[n.jsx(z,{size:20}),t.statistics.mostProductiveDay]}),n.jsx("p",{style:{fontSize:"1.5rem",fontWeight:300},children:s.mostProductiveDay==="Brak danych"?t.statistics.noData:s.mostProductiveDay})]}),n.jsxs("div",{className:"card",style:{cursor:"default"},children:[n.jsxs("h3",{style:{marginBottom:"var(--spacing-md)",fontWeight:500,display:"flex",alignItems:"center",gap:"var(--spacing-sm)"},children:[n.jsx(W,{size:20}),t.statistics.mostProductiveHour]}),n.jsxs("p",{style:{fontSize:"1.5rem",fontWeight:300},children:[s.mostProductiveHour,":00 - ",s.mostProductiveHour+1,":00"]})]}),n.jsxs("div",{className:"card",style:{cursor:"default"},children:[n.jsxs("h3",{style:{marginBottom:"var(--spacing-md)",fontWeight:500,display:"flex",alignItems:"center",gap:"var(--spacing-sm)"},children:[n.jsx(S,{size:20}),t.statistics.averageLength]}),n.jsxs("p",{style:{fontSize:"1.5rem",fontWeight:300},children:[s.averageLength," ",t.statistics.characters]})]}),s.mostUsedTags.length>0&&n.jsxs("div",{className:"card",style:{cursor:"default"},children:[n.jsxs("h3",{style:{marginBottom:"var(--spacing-md)",fontWeight:500,display:"flex",alignItems:"center",gap:"var(--spacing-sm)"},children:[n.jsx(A,{size:20}),t.statistics.popularTags]}),n.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"var(--spacing-md)"},children:s.mostUsedTags.map((a,i)=>n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"var(--spacing-md)"},children:[n.jsxs("span",{style:{fontSize:"1.5rem",fontWeight:300,minWidth:"2rem",color:"var(--light-text-secondary)"},children:[i+1,"."]}),n.jsx("div",{style:{flex:1},children:n.jsxs("div",{style:{height:"2rem",background:"var(--light-border)",borderRadius:"var(--radius-sm)",position:"relative",overflow:"hidden"},children:[n.jsx("div",{style:{position:"absolute",top:0,left:0,height:"100%",width:`${a.count/s.mostUsedTags[0].count*100}%`,background:"var(--light-accent)",transition:"width var(--transition-normal)"}}),n.jsx("span",{style:{position:"absolute",top:"50%",left:"var(--spacing-md)",transform:"translateY(-50%)",fontWeight:500,color:"white",mixBlendMode:"difference"},children:a.tag})]})}),n.jsx("span",{style:{fontWeight:500,minWidth:"3rem",textAlign:"right"},children:a.count})]},a.tag))})]})]})]})};export{ht as default};
