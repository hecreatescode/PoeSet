import{c as M,r as o,j as e,u as G,g as C,b as X,d as J,e as ee,f as te}from"./index-DQ036jwa.js";import{P as se}from"./PoemViewer-ByTe0l1R.js";import{u as ne,M as oe}from"./PoemEditor-kTO66wAS.js";import{T as le}from"./trash-2-DWynKt95.js";import{f as ae,p as ie,e as re}from"./pl-BLL9vXq1.js";import"./x-BtfzPclb.js";import"./save-Cjt1-djE.js";import"./tag-Y_04JHHk.js";import"./plus-DGgvFVBN.js";import"./differenceInCalendarDays-CYIPfUpj.js";const ce=[["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"M9 13h6",key:"1uhe8q"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],de=M("folder-plus",ce);const me=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],pe=M("funnel",me);const ue=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],he=M("search",ue);const ge=[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],xe=M("square-check-big",ge),ye=({content:n,children:N,maxWidth:P=300,delay:j=500})=>{const[f,i]=o.useState(!1),[b,r]=o.useState({top:0,left:0}),p=o.useRef(null),u=o.useRef(null),c=o.useRef(null),B=()=>{c.current=setTimeout(()=>{const x=u.current?.getBoundingClientRect();x&&(r({top:x.bottom+window.scrollY+8,left:x.left+window.scrollX+x.width/2}),i(!0))},j)},g=()=>{c.current&&clearTimeout(c.current),i(!1)};return o.useEffect(()=>()=>{c.current&&clearTimeout(c.current)},[]),e.jsxs("div",{ref:u,className:"tooltip-container",onMouseEnter:B,onMouseLeave:g,children:[N,f&&e.jsx("div",{ref:p,className:"tooltip",style:{top:`${b.top}px`,left:`${b.left}px`,maxWidth:`${P}px`},children:n})]})},F=20,Ne=()=>{const{t:n,language:N}=G(),P=N==="pl"?ie:re,[j,f]=o.useState(()=>C()),[i,b]=o.useState(""),[r,p]=o.useState(null),[u,c]=o.useState("newest"),B=X(),[g,x]=o.useState(F),[I,H]=o.useState(!1),[v,R]=o.useState(""),[S,D]=o.useState(""),[w,A]=o.useState(""),[k,E]=o.useState(""),[z,_]=o.useState(""),[h,L]=o.useState(!1),[a,y]=o.useState(new Set),[W,T]=o.useState(!1),$=o.useRef(null);ne([{key:"f",ctrlKey:!0,callback:()=>$.current?.focus(),description:"Search (Ctrl+F)"},{key:"Escape",callback:()=>r&&p(null),description:"Close (Esc)"},{key:"ArrowLeft",callback:()=>{if(r){const t=l.findIndex(s=>s.id===r.id);t>0&&p(l[t-1])}},description:"Poprzedni wiersz (←)"},{key:"ArrowRight",callback:()=>{if(r){const t=l.findIndex(s=>s.id===r.id);t<l.length-1&&p(l[t+1])}},description:"Następny wiersz (→)"}]);const l=o.useMemo(()=>{let t=[...j];return i&&(t=t.filter(s=>s.title.toLowerCase().includes(i.toLowerCase())||s.content.toLowerCase().includes(i.toLowerCase())||s.tags.some(m=>m.toLowerCase().includes(i.toLowerCase())))),v&&(t=t.filter(s=>s.date>=v)),S&&(t=t.filter(s=>s.date<=S+"T23:59:59")),w&&(t=t.filter(s=>s.content.length>=parseInt(w))),k&&(t=t.filter(s=>s.content.length<=parseInt(k))),z&&(t=t.filter(s=>s.mood===z)),t.sort((s,m)=>{switch(u){case"newest":return new Date(m.date).getTime()-new Date(s.date).getTime();case"oldest":return new Date(s.date).getTime()-new Date(m.date).getTime();case"alphabetical":return s.title.localeCompare(m.title);default:return 0}}),t},[j,i,u,v,S,w,k,z]),d=o.useMemo(()=>l.slice(0,g),[l,g]),V=g<l.length,q=()=>{const t=C();f(t),p(null)},U=()=>{L(!h),y(new Set)},O=t=>{const s=new Set(a);s.has(t)?s.delete(t):s.add(t),y(s)},Z=()=>{a.size===d.length?y(new Set):y(new Set(d.map(t=>t.id)))},K=()=>{if(a.size===0)return;const t=a.size;if(confirm(`Czy na pewno chcesz usunąć ${t} ${t===1?"wiersz":"wierszy"}?`)){a.forEach(m=>ee(m));const s=C();f(s),y(new Set),L(!1)}},Q=t=>{a.forEach(m=>{te(m,t)});const s=C();f(s),y(new Set),T(!1),L(!1)},Y=()=>{x(t=>t+F)};return e.jsxs("div",{style:{padding:"var(--spacing-lg)"},children:[e.jsxs("header",{style:{marginBottom:"var(--spacing-xl)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.5rem"},children:[e.jsx("h1",{style:{fontSize:"2rem",margin:0,fontWeight:300},children:n.poems.title}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[h&&a.size>0&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{className:"button button-secondary",onClick:()=>T(!0),style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(de,{size:18}),"Dodaj do kolekcji (",a.size,")"]}),e.jsxs("button",{className:"button button-secondary",onClick:K,style:{display:"flex",alignItems:"center",gap:"0.5rem",color:"#ef4444"},children:[e.jsx(le,{size:18}),"Usuń (",a.size,")"]})]}),e.jsxs("button",{className:`button ${h?"button-primary":"button-secondary"}`,onClick:U,style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(xe,{size:18}),h?"Anuluj":"Zaznacz"]})]})]}),e.jsx("p",{className:"text-secondary",children:n.poems.subtitle})]}),e.jsxs("div",{style:{marginBottom:"var(--spacing-lg)"},children:[e.jsxs("div",{style:{position:"relative",marginBottom:"var(--spacing-md)"},children:[e.jsx(he,{size:20,style:{position:"absolute",left:"1rem",top:"50%",transform:"translateY(-50%)",opacity:.5}}),e.jsx("input",{ref:$,type:"text",className:"input",placeholder:n.poems.search,value:i,onChange:t=>b(t.target.value),style:{paddingLeft:"3rem"}})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:[e.jsx("button",{className:`button ${u==="newest"?"button-primary":"button-secondary"}`,onClick:()=>c("newest"),style:{fontSize:"0.875rem",padding:"0.5rem 1rem"},children:n.poems.newest}),e.jsx("button",{className:`button ${u==="oldest"?"button-primary":"button-secondary"}`,onClick:()=>c("oldest"),style:{fontSize:"0.875rem",padding:"0.5rem 1rem"},children:n.poems.oldest}),e.jsx("button",{className:`button ${u==="alphabetical"?"button-primary":"button-secondary"}`,onClick:()=>c("alphabetical"),style:{fontSize:"0.875rem",padding:"0.5rem 1rem"},children:n.poems.alphabetical}),e.jsxs("button",{className:"button button-secondary",onClick:()=>H(!I),style:{fontSize:"0.875rem",padding:"0.5rem 1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(pe,{size:16}),n.poems.filters]})]}),I&&e.jsxs("div",{style:{marginTop:"var(--spacing-md)",padding:"var(--spacing-md)",border:"1px solid var(--border-color)",borderRadius:"0.5rem",display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"var(--spacing-md)"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"0.875rem",marginBottom:"0.5rem",opacity:.7},children:n.poems.dateFrom}),e.jsx("input",{type:"date",className:"input",value:v,onChange:t=>R(t.target.value),style:{fontSize:"0.875rem"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"0.875rem",marginBottom:"0.5rem",opacity:.7},children:n.poems.dateTo}),e.jsx("input",{type:"date",className:"input",value:S,onChange:t=>D(t.target.value),style:{fontSize:"0.875rem"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"0.875rem",marginBottom:"0.5rem",opacity:.7},children:n.poems.minLength}),e.jsx("input",{type:"number",className:"input",placeholder:"0",value:w,onChange:t=>A(t.target.value),style:{fontSize:"0.875rem"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"0.875rem",marginBottom:"0.5rem",opacity:.7},children:n.poems.maxLength}),e.jsx("input",{type:"number",className:"input",placeholder:"∞",value:k,onChange:t=>E(t.target.value),style:{fontSize:"0.875rem"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"0.875rem",marginBottom:"0.5rem",opacity:.7},children:n.poems.mood}),e.jsxs("select",{className:"input",value:z,onChange:t=>_(t.target.value),style:{fontSize:"0.875rem"},children:[e.jsx("option",{value:"",children:n.poems.allMoods}),e.jsx("option",{value:"happy",children:n.mood.happy}),e.jsx("option",{value:"sad",children:n.mood.sad}),e.jsx("option",{value:"neutral",children:n.mood.neutral}),e.jsx("option",{value:"inspired",children:n.mood.inspired}),e.jsx("option",{value:"melancholic",children:n.mood.melancholic}),e.jsx("option",{value:"excited",children:n.mood.excited}),e.jsx("option",{value:"calm",children:n.mood.calm}),e.jsx("option",{value:"anxious",children:n.mood.anxious})]})]}),e.jsx("div",{style:{display:"flex",alignItems:"flex-end"},children:e.jsx("button",{className:"button button-secondary",onClick:()=>{R(""),D(""),A(""),E(""),_("")},style:{fontSize:"0.875rem",width:"100%"},children:n.poems.clearFilters})})]})]}),l.length===0?e.jsx("div",{style:{textAlign:"center",padding:"3rem 1rem"},children:e.jsx("p",{className:"text-secondary",children:i?n.poems.noResults:n.poems.noPoems})}):e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"text-secondary mb-md",style:{fontSize:"0.875rem"},children:[l.length," ",l.length===1?n.poems.countSingular:n.poems.count,d.length<l.length&&e.jsxs("span",{children:[" (",n.poems.shown," ",d.length,")"]})]}),h&&d.length>0&&e.jsx("div",{style:{marginBottom:"0.5rem"},children:e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:a.size===d.length&&d.length>0,onChange:Z,style:{width:"18px",height:"18px"}}),e.jsxs("span",{style:{fontSize:"0.9rem",fontWeight:500},children:["Zaznacz wszystkie (",d.length,")"]})]})}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"var(--spacing-md)"},children:d.map(t=>e.jsx(ye,{content:e.jsxs("div",{className:"tooltip-content-preview",children:[e.jsx("strong",{children:t.title||n.editor.untitled}),e.jsx("br",{}),t.content.substring(0,200),t.content.length>200&&"..."]}),delay:800,children:e.jsxs("div",{className:"card",onClick:()=>!h&&p(t),style:{cursor:h?"default":"pointer",display:"flex",gap:"1rem"},children:[h&&e.jsx("div",{style:{paddingTop:"0.25rem"},children:e.jsx("input",{type:"checkbox",checked:a.has(t.id),onChange:()=>O(t.id),onClick:s=>s.stopPropagation(),style:{width:"20px",height:"20px",cursor:"pointer"}})}),e.jsxs("div",{style:{flex:1},children:[e.jsx("h3",{style:{marginBottom:"0.5rem",fontWeight:500},children:t.title||n.editor.untitled}),e.jsx("p",{className:"text-secondary",style:{fontSize:"0.875rem",marginBottom:"1rem"},children:ae(new Date(t.date),"d MMMM yyyy",{locale:P})}),B.enableMarkdown?e.jsx("div",{className:"markdown-preview",style:{lineHeight:1.6,maxHeight:"100px",overflow:"hidden",textOverflow:"ellipsis"},dangerouslySetInnerHTML:{__html:oe.parse(t.content.substring(0,200)+(t.content.length>200?"...":""))}}):e.jsx("p",{style:{whiteSpace:"pre-wrap",lineHeight:1.6,maxHeight:"100px",overflow:"hidden",textOverflow:"ellipsis"},children:t.content}),t.tags.length>0&&e.jsxs("div",{style:{marginTop:"1rem",display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:[t.tags.slice(0,3).map(s=>e.jsx("span",{style:{fontSize:"0.75rem",padding:"0.25rem 0.75rem",borderRadius:"var(--radius-full)",background:"var(--light-border)"},children:s},s)),t.tags.length>3&&e.jsxs("span",{style:{fontSize:"0.75rem",padding:"0.25rem 0.75rem",borderRadius:"var(--radius-full)",background:"var(--light-border)"},children:["+",t.tags.length-3]})]})]})]})},t.id))}),V&&e.jsxs("button",{className:"button button-secondary",onClick:Y,style:{marginTop:"var(--spacing-lg)",width:"100%"},children:[n.poems.loadMore," (",l.length-g," ",n.poems.remaining,")"]})]}),r&&e.jsx(se,{poem:r,onClose:()=>p(null),onUpdate:q}),W&&e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:e.jsxs("div",{style:{background:"var(--bg-primary)",padding:"2rem",borderRadius:"1rem",maxWidth:"400px",width:"90%"},children:[e.jsx("h2",{style:{marginBottom:"1rem",fontSize:"1.25rem"},children:"Dodaj do kolekcji"}),e.jsxs("p",{style:{marginBottom:"1rem",color:"var(--text-secondary)",fontSize:"0.9rem"},children:["Wybierz kolekcję, do której chcesz dodać zaznaczone wiersze (",a.size,")"]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem",marginBottom:"1rem"},children:J().map(t=>e.jsx("button",{className:"button button-secondary",onClick:()=>Q(t.id),style:{width:"100%",justifyContent:"flex-start"},children:t.name},t.id))}),e.jsx("button",{className:"button button-secondary",onClick:()=>T(!1),style:{width:"100%"},children:"Anuluj"})]})})]})};export{Ne as default};
