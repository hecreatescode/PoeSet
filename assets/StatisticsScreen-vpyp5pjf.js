import{c as C,u as B,g as H,j as n,C as k}from"./index-D0r3zMPe.js";import{n as Y,d as L,t as h,c as F,a as I,b,s as _,C as S,T as A}from"./differenceInCalendarDays-dV1H3lww.js";const R=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],W=C("clock",R);const $=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],E=C("trending-up",$);function Z(e,t,s){const[a,r]=Y(s?.in,e,t),c=w(a,r),g=Math.abs(L(a,r));a.setDate(a.getDate()-c*g);const u=+(w(a,r)===-c),d=c*(g-u);return d===0?0:d}function w(e,t){const s=e.getFullYear()-t.getFullYear()||e.getMonth()-t.getMonth()||e.getDate()-t.getDate()||e.getHours()-t.getHours()||e.getMinutes()-t.getMinutes()||e.getSeconds()-t.getSeconds()||e.getMilliseconds()-t.getMilliseconds();return s<0?-1:s>0?1:s}function J(e,t){const s=h(e,t?.in);return s.setDate(1),s.setHours(0,0,0,0),s}function q(e,t){return h(e,t?.in).getDay()}function G(e,t){return h(e,t?.in).getHours()}function y(e,t){const s=()=>F(t?.in,NaN),r=X(e);let c;if(r.date){const l=tt(r.date,2);c=et(l.restDateString,l.year)}if(!c||isNaN(+c))return s();const g=+c;let u=0,d;if(r.time&&(u=st(r.time),isNaN(u)))return s();if(r.timezone){if(d=nt(r.timezone),isNaN(d))return s()}else{const l=new Date(g+u),m=h(0,t?.in);return m.setFullYear(l.getUTCFullYear(),l.getUTCMonth(),l.getUTCDate()),m.setHours(l.getUTCHours(),l.getUTCMinutes(),l.getUTCSeconds(),l.getUTCMilliseconds()),m}return h(g+u+d,t?.in)}const v={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},K=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,Q=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,V=/^([+-])(\d{2})(?::?(\d{2}))?$/;function X(e){const t={},s=e.split(v.dateTimeDelimiter);let a;if(s.length>2)return t;if(/:/.test(s[0])?a=s[0]:(t.date=s[0],a=s[1],v.timeZoneDelimiter.test(t.date)&&(t.date=e.split(v.timeZoneDelimiter)[0],a=e.substr(t.date.length,e.length))),a){const r=v.timezone.exec(a);r?(t.time=a.replace(r[1],""),t.timezone=r[1]):t.time=a}return t}function tt(e,t){const s=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),a=e.match(s);if(!a)return{year:NaN,restDateString:""};const r=a[1]?parseInt(a[1]):null,c=a[2]?parseInt(a[2]):null;return{year:c===null?r:c*100,restDateString:e.slice((a[1]||a[2]).length)}}function et(e,t){if(t===null)return new Date(NaN);const s=e.match(K);if(!s)return new Date(NaN);const a=!!s[4],r=f(s[1]),c=f(s[2])-1,g=f(s[3]),u=f(s[4]),d=f(s[5])-1;if(a)return ct(t,u,d)?at(t,u,d):new Date(NaN);{const l=new Date(0);return!it(t,c,g)||!ot(t,r)?new Date(NaN):(l.setUTCFullYear(t,c,Math.max(r,g)),l)}}function f(e){return e?parseInt(e):1}function st(e){const t=e.match(Q);if(!t)return NaN;const s=N(t[1]),a=N(t[2]),r=N(t[3]);return lt(s,a,r)?s*I+a*b+r*1e3:NaN}function N(e){return e&&parseFloat(e.replace(",","."))||0}function nt(e){if(e==="Z")return 0;const t=e.match(V);if(!t)return 0;const s=t[1]==="+"?-1:1,a=parseInt(t[2]),r=t[3]&&parseInt(t[3])||0;return dt(a,r)?s*(a*I+r*b):NaN}function at(e,t,s){const a=new Date(0);a.setUTCFullYear(e,0,4);const r=a.getUTCDay()||7,c=(t-1)*7+s+1-r;return a.setUTCDate(a.getUTCDate()+c),a}const rt=[31,null,31,30,31,30,31,31,30,31,30,31];function M(e){return e%400===0||e%4===0&&e%100!==0}function it(e,t,s){return t>=0&&t<=11&&s>=1&&s<=(rt[t]||(M(e)?29:28))}function ot(e,t){return t>=1&&t<=(M(e)?366:365)}function ct(e,t,s){return t>=1&&t<=53&&s>=0&&s<=6}function lt(e,t,s){return e===24?t===0&&s===0:s>=0&&s<60&&t>=0&&t<60&&e>=0&&e<25}function dt(e,t){return t>=0&&t<=59}const ut=e=>{if(e.length===0)return{totalPoems:0,poemsThisWeek:0,poemsThisMonth:0,averageLength:0,mostUsedTags:[],writingStreak:0,mostProductiveDay:"Brak danych",mostProductiveHour:0};const t=new Date,s=_(t,{weekStartsOn:1}),a=J(t),r=e.filter(i=>y(i.date)>=s).length,c=e.filter(i=>y(i.date)>=a).length,g=e.reduce((i,o)=>i+o.content.length,0),u=Math.round(g/e.length),d={};e.forEach(i=>{i.tags.forEach(o=>{d[o]=(d[o]||0)+1})});const l=Object.entries(d).map(([i,o])=>({tag:i,count:o})).sort((i,o)=>o.count-i.count).slice(0,5),m=e.map(i=>i.date.split("T")[0]).filter((i,o,x)=>x.indexOf(i)===o).sort().reverse();let D=0;const U=t.toISOString().split("T")[0];if(m.length>0){let i=new Date(U);for(const o of m){const x=new Date(o),T=Z(i,x);if(T===0||T===1)D++,i=x;else break}}const j={};e.forEach(i=>{const o=q(y(i.date));j[o]=(j[o]||0)+1});const z=Object.entries(j).sort((i,o)=>o[1]-i[1])[0]?.[0],P=z?["Niedziela","Poniedziałek","Wtorek","Środa","Czwartek","Piątek","Sobota"][parseInt(z)]:"Brak danych",p={};e.forEach(i=>{const o=G(y(i.createdAt||i.date));p[o]=(p[o]||0)+1});const O=Object.entries(p).sort((i,o)=>o[1]-i[1])[0]?.[0]?parseInt(Object.entries(p).sort((i,o)=>o[1]-i[1])[0][0]):0;return{totalPoems:e.length,poemsThisWeek:r,poemsThisMonth:c,averageLength:u,mostUsedTags:l,writingStreak:D,mostProductiveDay:P,mostProductiveHour:O}},ht=()=>{const{t:e}=B(),t=H(),s=ut(t);return n.jsxs("div",{children:[n.jsxs("header",{className:"mb-xl",children:[n.jsx("h1",{style:{fontSize:"2rem",marginBottom:"0.5rem",fontWeight:300},children:e.statistics.title}),n.jsx("p",{className:"text-secondary",children:e.statistics.subtitle})]}),n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(150px, 1fr))",gap:"var(--spacing-md)",marginBottom:"var(--spacing-xl)"},children:[n.jsxs("div",{className:"card",style:{textAlign:"center",cursor:"default"},children:[n.jsx(k,{size:32,style:{margin:"0 auto var(--spacing-sm)",opacity:.6}}),n.jsx("p",{style:{fontSize:"2rem",fontWeight:300,marginBottom:"var(--spacing-xs)"},children:s.totalPoems}),n.jsx("p",{className:"text-secondary",style:{fontSize:"0.875rem"},children:e.statistics.totalPoems})]}),n.jsxs("div",{className:"card",style:{textAlign:"center",cursor:"default"},children:[n.jsx(E,{size:32,style:{margin:"0 auto var(--spacing-sm)",opacity:.6}}),n.jsx("p",{style:{fontSize:"2rem",fontWeight:300,marginBottom:"var(--spacing-xs)"},children:s.writingStreak}),n.jsx("p",{className:"text-secondary",style:{fontSize:"0.875rem"},children:e.statistics.currentStreak})]}),n.jsxs("div",{className:"card",style:{textAlign:"center",cursor:"default"},children:[n.jsx(S,{size:32,style:{margin:"0 auto var(--spacing-sm)",opacity:.6}}),n.jsx("p",{style:{fontSize:"2rem",fontWeight:300,marginBottom:"var(--spacing-xs)"},children:s.poemsThisWeek}),n.jsx("p",{className:"text-secondary",style:{fontSize:"0.875rem"},children:e.statistics.averagePerWeek})]}),n.jsxs("div",{className:"card",style:{textAlign:"center",cursor:"default"},children:[n.jsx(W,{size:32,style:{margin:"0 auto var(--spacing-sm)",opacity:.6}}),n.jsx("p",{style:{fontSize:"2rem",fontWeight:300,marginBottom:"var(--spacing-xs)"},children:s.poemsThisMonth}),n.jsx("p",{className:"text-secondary",style:{fontSize:"0.875rem"},children:e.statistics.mostProductiveDay})]})]}),n.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"var(--spacing-lg)"},children:[n.jsxs("div",{className:"card",style:{cursor:"default"},children:[n.jsxs("h3",{style:{marginBottom:"var(--spacing-md)",fontWeight:500,display:"flex",alignItems:"center",gap:"var(--spacing-sm)"},children:[n.jsx(S,{size:20}),"Najbardziej twórczy dzień"]}),n.jsx("p",{style:{fontSize:"1.5rem",fontWeight:300},children:s.mostProductiveDay})]}),n.jsxs("div",{className:"card",style:{cursor:"default"},children:[n.jsxs("h3",{style:{marginBottom:"var(--spacing-md)",fontWeight:500,display:"flex",alignItems:"center",gap:"var(--spacing-sm)"},children:[n.jsx(W,{size:20}),"Najbardziej twórcza godzina"]}),n.jsxs("p",{style:{fontSize:"1.5rem",fontWeight:300},children:[s.mostProductiveHour,":00 - ",s.mostProductiveHour+1,":00"]})]}),n.jsxs("div",{className:"card",style:{cursor:"default"},children:[n.jsxs("h3",{style:{marginBottom:"var(--spacing-md)",fontWeight:500,display:"flex",alignItems:"center",gap:"var(--spacing-sm)"},children:[n.jsx(k,{size:20}),"Średnia długość wiersza"]}),n.jsxs("p",{style:{fontSize:"1.5rem",fontWeight:300},children:[s.averageLength," znaków"]})]}),s.mostUsedTags.length>0&&n.jsxs("div",{className:"card",style:{cursor:"default"},children:[n.jsxs("h3",{style:{marginBottom:"var(--spacing-md)",fontWeight:500,display:"flex",alignItems:"center",gap:"var(--spacing-sm)"},children:[n.jsx(A,{size:20}),e.statistics.popularTags]}),n.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"var(--spacing-md)"},children:s.mostUsedTags.map((a,r)=>n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"var(--spacing-md)"},children:[n.jsxs("span",{style:{fontSize:"1.5rem",fontWeight:300,minWidth:"2rem",color:"var(--light-text-secondary)"},children:[r+1,"."]}),n.jsx("div",{style:{flex:1},children:n.jsxs("div",{style:{height:"2rem",background:"var(--light-border)",borderRadius:"var(--radius-sm)",position:"relative",overflow:"hidden"},children:[n.jsx("div",{style:{position:"absolute",top:0,left:0,height:"100%",width:`${a.count/s.mostUsedTags[0].count*100}%`,background:"var(--light-accent)",transition:"width var(--transition-normal)"}}),n.jsx("span",{style:{position:"absolute",top:"50%",left:"var(--spacing-md)",transform:"translateY(-50%)",fontWeight:500,color:"white",mixBlendMode:"difference"},children:a.tag})]})}),n.jsx("span",{style:{fontWeight:500,minWidth:"3rem",textAlign:"right"},children:a.count})]},a.tag))})]})]})]})};export{ht as default};
