import{r as i,g as C,j as e,b as N,d as k,u as B,e as j,F as P}from"./index-BL24ehDD.js";import{X as S,S as D,f as b,p as v}from"./PoemEditor-CGiMNYbA.js";import{P as I,S as W,T as $}from"./PoemViewer-BA7zLe5P.js";import{D as O}from"./download-C36OcuQb.js";import{P as E}from"./plus-B6pHFIH6.js";import"./differenceInCalendarDays-DlAfXj1i.js";const z=["#2c2c2c","#dc2626","#ea580c","#d97706","#65a30d","#16a34a","#0891b2","#2563eb","#7c3aed","#c026d3","#db2777","#8d6e63"],w=({collection:t,onSave:r,onClose:m})=>{const[d,a]=i.useState(t?.name||""),[p,o]=i.useState(t?.description||""),[l,h]=i.useState(t?.color||z[0]),[c,y]=i.useState(t?.poemIds||[]),[x]=i.useState(()=>C()),n=()=>{if(!d.trim())return;const s={id:t?.id||`collection_${Date.now()}`,name:d.trim(),description:p.trim(),color:l,poemIds:c,createdAt:t?.createdAt||new Date().toISOString()};N(s),r()},u=s=>{y(g=>g.includes(s)?g.filter(f=>f!==s):[...g,s])};return e.jsxs("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"var(--light-bg)",zIndex:1e3,display:"flex",flexDirection:"column"},children:[e.jsxs("div",{style:{padding:"var(--spacing-md)",borderBottom:"1px solid var(--light-border)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("button",{className:"button button-secondary",onClick:m,style:{padding:"0.5rem"},children:e.jsx(S,{size:20})}),e.jsxs("button",{className:"button button-primary",onClick:n,disabled:!d.trim(),children:[e.jsx(D,{size:20}),"Zapisz"]})]}),e.jsxs("div",{style:{flex:1,padding:"var(--spacing-xl)",overflow:"auto"},children:[e.jsx("input",{type:"text",className:"input",placeholder:"Nazwa zbioru",value:d,onChange:s=>a(s.target.value),style:{fontSize:"1.5rem",fontWeight:500,marginBottom:"var(--spacing-lg)"}}),e.jsx("textarea",{className:"input",placeholder:"Opis (opcjonalny)",value:p,onChange:s=>o(s.target.value),style:{minHeight:"100px",marginBottom:"var(--spacing-lg)"}}),e.jsxs("div",{style:{marginBottom:"var(--spacing-xl)"},children:[e.jsx("label",{style:{display:"block",marginBottom:"var(--spacing-sm)",fontWeight:500},children:"Kolor zbioru"}),e.jsx("div",{style:{display:"flex",gap:"var(--spacing-sm)",flexWrap:"wrap"},children:z.map(s=>e.jsx("button",{onClick:()=>h(s),style:{width:"40px",height:"40px",borderRadius:"var(--radius-md)",background:s,border:l===s?"3px solid var(--light-accent)":"1px solid var(--light-border)",cursor:"pointer",transition:"all var(--transition-fast)"}},s))})]}),e.jsxs("div",{children:[e.jsxs("label",{style:{display:"block",marginBottom:"var(--spacing-md)",fontWeight:500},children:["Wybierz wiersze (",c.length,")"]}),x.length===0?e.jsx("p",{className:"text-secondary",children:"Nie masz jeszcze żadnych wierszy."}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"var(--spacing-sm)"},children:x.map(s=>e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"var(--spacing-md)",padding:"var(--spacing-md)",border:"1px solid var(--light-border)",borderRadius:"var(--radius-md)",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:c.includes(s.id),onChange:()=>u(s.id),style:{width:"18px",height:"18px"}}),e.jsxs("div",{style:{flex:1},children:[e.jsx("p",{style:{fontWeight:500},children:s.title||"Bez tytułu"}),e.jsxs("p",{className:"text-secondary",style:{fontSize:"0.875rem"},children:[s.content.substring(0,50),"..."]})]})]},s.id))})]})]})]})},M=({collection:t,onClose:r,onUpdate:m})=>{const[d,a]=i.useState(!1),[p,o]=i.useState(null),l=i.useMemo(()=>C().filter(u=>t.poemIds.includes(u.id)),[t.poemIds]),h=()=>{window.confirm("Czy na pewno chcesz usunąć ten zbiór?")&&(k(t.id),m(),r())},c=()=>{const n=`${t.name}
${t.description?t.description+`
`:""}
${"=".repeat(50)}

`+l.map(f=>`${f.title||"Bez tytułu"}

${f.content}

${b(new Date(f.date),"d MMMM yyyy",{locale:v})}

---

`).join(""),u=new Blob([n],{type:"text/plain"}),s=URL.createObjectURL(u),g=document.createElement("a");g.href=s,g.download=`${t.name}.txt`,g.click()},y=()=>{a(!1),m()},x=()=>{m(),o(null)};return d?e.jsx(w,{collection:t,onSave:y,onClose:()=>a(!1)}):p?e.jsx(I,{poem:p,onClose:()=>o(null),onUpdate:x}):e.jsxs("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"var(--light-bg)",zIndex:1e3,display:"flex",flexDirection:"column"},children:[e.jsxs("div",{style:{padding:"var(--spacing-md)",borderBottom:"1px solid var(--light-border)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("button",{className:"button button-secondary",onClick:r,style:{padding:"0.5rem"},children:e.jsx(S,{size:20})}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsx("button",{className:"button button-secondary",onClick:c,style:{padding:"0.5rem"},children:e.jsx(O,{size:20})}),e.jsx("button",{className:"button button-secondary",onClick:()=>a(!0),style:{padding:"0.5rem"},children:e.jsx(W,{size:20})}),e.jsx("button",{className:"button button-secondary",onClick:h,style:{padding:"0.5rem",color:"#dc2626"},children:e.jsx($,{size:20})})]})]}),e.jsxs("div",{style:{flex:1,padding:"var(--spacing-xl)",overflow:"auto"},children:[e.jsxs("div",{style:{borderLeft:`4px solid ${t.color}`,paddingLeft:"var(--spacing-lg)",marginBottom:"var(--spacing-xl)"},children:[e.jsx("h1",{style:{fontSize:"2rem",marginBottom:"0.5rem",fontWeight:400},children:t.name}),t.description&&e.jsx("p",{className:"text-secondary",style:{fontSize:"1rem"},children:t.description}),e.jsxs("p",{className:"text-secondary",style:{fontSize:"0.875rem",marginTop:"var(--spacing-md)"},children:[l.length," ",l.length===1?"wiersz":"wierszy"]})]}),l.length===0?e.jsx("div",{style:{textAlign:"center",padding:"3rem 1rem"},children:e.jsx("p",{className:"text-secondary",children:"Ten zbiór nie zawiera jeszcze żadnych wierszy."})}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"var(--spacing-md)"},children:l.map(n=>e.jsxs("div",{className:"card",onClick:()=>o(n),children:[e.jsx("h3",{style:{marginBottom:"0.5rem",fontWeight:500},children:n.title||"Bez tytułu"}),e.jsx("p",{className:"text-secondary",style:{fontSize:"0.875rem",marginBottom:"1rem"},children:b(new Date(n.date),"d MMMM yyyy",{locale:v})}),e.jsx("p",{style:{whiteSpace:"pre-wrap",lineHeight:1.6,maxHeight:"100px",overflow:"hidden",textOverflow:"ellipsis"},children:n.content})]},n.id))})]})]})},H=()=>{const{t}=B(),[r,m]=i.useState(j()),[d,a]=i.useState(!1),[p,o]=i.useState(null),[l,h]=i.useState(null),c=()=>{const n=j();m(n)},y=()=>{c(),a(!1),o(null)},x=n=>r.find(s=>s.id===n)?.poemIds.length||0;return e.jsxs("div",{children:[e.jsxs("header",{className:"mb-xl",children:[e.jsx("h1",{style:{fontSize:"2rem",marginBottom:"0.5rem",fontWeight:300},children:t.collections.title}),e.jsx("p",{className:"text-secondary",children:t.collections.subtitle})]}),e.jsxs("button",{className:"button button-primary mb-lg",onClick:()=>{o(null),a(!0)},children:[e.jsx(E,{size:20}),t.collections.newCollection]}),r.length===0?e.jsxs("div",{style:{textAlign:"center",padding:"3rem 1rem"},children:[e.jsx(P,{size:48,style:{opacity:.3,margin:"0 auto 1rem"}}),e.jsx("p",{className:"text-secondary",children:t.collections.noCollections}),e.jsx("p",{className:"text-secondary",style:{marginTop:"0.5rem"},children:t.collections.createFirst})]}):e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(250px, 1fr))",gap:"var(--spacing-md)"},children:r.map(n=>e.jsxs("div",{className:"card",onClick:()=>h(n),style:{borderLeft:`4px solid ${n.color}`},children:[e.jsx("h3",{style:{marginBottom:"0.5rem",fontWeight:500},children:n.name}),n.description&&e.jsx("p",{className:"text-secondary",style:{fontSize:"0.875rem",marginBottom:"1rem",overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical"},children:n.description}),e.jsxs("p",{className:"text-secondary",style:{fontSize:"0.75rem"},children:[x(n.id)," ",x(n.id)===1?t.collections.poemsSingular:t.collections.poems]})]},n.id))}),d&&e.jsx(w,{collection:p||void 0,onSave:y,onClose:()=>{a(!1),o(null)}}),l&&e.jsx(M,{collection:l,onClose:()=>h(null),onUpdate:c})]})};export{H as default};
