import{c as b,r as c,u as R,w as $,g as C,x as E,y as H,R as I,j as e,z as W,A as F}from"./index-DQ036jwa.js";import{t as _,g as L,s as Y}from"./differenceInCalendarDays-CYIPfUpj.js";import{P as q}from"./plus-DGgvFVBN.js";import{s as V}from"./startOfMonth-VWHcTyc_.js";import{f as S,p as A}from"./pl-BLL9vXq1.js";const J=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],K=b("circle-check",J);const Q=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],U=b("circle",Q);const X=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],Z=b("target",X);const ee=[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]],te=b("trophy",ee);function se(g,d){const i=_(g,d?.in),y=i.getMonth();return i.setFullYear(i.getFullYear(),y+1,0),i.setHours(23,59,59,999),i}function re(g,d){const i=L(),y=d?.weekStartsOn??d?.locale?.options?.weekStartsOn??i.weekStartsOn??i.locale?.options?.weekStartsOn??0,l=_(g,d?.in),u=l.getDay(),f=(u<y?-7:0)+6-(u-y);return l.setDate(l.getDate()+f),l.setHours(23,59,59,999),l}const ce=()=>{const[g,d]=c.useState([]),[i,y]=c.useState([]),[l,u]=c.useState("goals"),[f,k]=c.useState(!1),[G,N]=c.useState("weekly"),[j,M]=c.useState("7"),[w,z]=c.useState(""),{t:s}=R(),D=c.useCallback(()=>{const t=$(),r=C(),a=new Date,n=t.map(o=>{let m=0;const O=new Date(o.startDate);switch(o.type){case"daily":m=r.filter(p=>S(new Date(p.date),"yyyy-MM-dd")===S(a,"yyyy-MM-dd")).length;break;case"weekly":{const p=Y(a,{locale:A}),x=re(a,{locale:A});m=r.filter(h=>{const v=new Date(h.date);return v>=p&&v<=x}).length;break}case"monthly":{const p=V(a),x=se(a);m=r.filter(h=>{const v=new Date(h.date);return v>=p&&v<=x}).length;break}case"custom":{const p=o.endDate?new Date(o.endDate):a;m=r.filter(x=>{const h=new Date(x.date);return h>=O&&h<=p}).length;break}}return{...o,current:m}});d(n)},[]),B=c.useCallback(()=>{const t=E();t.length===0&&[{id:"first_poem",title:s.achievements.firstPoem,description:s.achievements.firstPoemDesc,icon:"âœ’ï¸",progress:0,maxProgress:1},{id:"streak_7",title:s.achievements.streak7,description:s.achievements.streak7Desc,icon:"ðŸ”¥",progress:0,maxProgress:7},{id:"poems_50",title:s.achievements.poems50,description:s.achievements.poems50Desc,icon:"ðŸ“š",progress:0,maxProgress:50},{id:"poems_100",title:s.achievements.poems100,description:s.achievements.poems100Desc,icon:"ðŸ†",progress:0,maxProgress:100}].forEach(o=>H(o));const r=C(),a=t.map(n=>{let o=n.progress;n.id==="first_poem"&&r.length>0?o=1:n.id==="poems_50"?o=Math.min(r.length,50):n.id==="poems_100"&&(o=Math.min(r.length,100));const m=o>=n.maxProgress;return{...n,progress:o,unlockedAt:m&&!n.unlockedAt?new Date().toISOString():n.unlockedAt}});y(a)},[s]);I.useEffect(()=>{D(),B()},[]);const P=()=>{if(!w.trim()||!j)return;const t=new Date().toISOString(),r={id:`goal_${Date.now()}`,type:G,target:parseInt(j),current:0,startDate:t,title:w.trim()};W(r),D(),k(!1),z(""),M("7"),N("weekly")},T=t=>{F(t),D()};return e.jsxs("div",{style:{padding:"var(--spacing-lg)"},children:[e.jsxs("header",{style:{marginBottom:"var(--spacing-xl)"},children:[e.jsx("h1",{style:{fontSize:"2rem",marginBottom:"0.5rem",fontWeight:300},children:s.goals.title}),e.jsx("p",{className:"text-secondary",children:s.goals.subtitle})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"var(--spacing-lg)",borderBottom:"1px solid var(--border-color)"},children:[e.jsxs("button",{className:`button ${l==="goals"?"button-primary":"button-secondary"}`,onClick:()=>u("goals"),style:{borderRadius:"0.5rem 0.5rem 0 0",borderBottom:"none"},children:[e.jsx(Z,{size:18}),s.goals.title]}),e.jsxs("button",{className:`button ${l==="achievements"?"button-primary":"button-secondary"}`,onClick:()=>u("achievements"),style:{borderRadius:"0.5rem 0.5rem 0 0",borderBottom:"none"},children:[e.jsx(te,{size:18}),s.achievements.title]})]}),l==="goals"&&e.jsxs("div",{children:[e.jsxs("button",{className:"button button-primary",onClick:()=>k(!f),style:{marginBottom:"var(--spacing-md)"},children:[e.jsx(q,{size:20}),s.goals.newGoal]}),f&&e.jsxs("div",{style:{padding:"var(--spacing-md)",border:"1px solid var(--border-color)",borderRadius:"0.5rem",marginBottom:"var(--spacing-md)",background:"var(--bg-secondary)"},children:[e.jsx("input",{type:"text",className:"input",placeholder:s.goals.title,value:w,onChange:t=>z(t.target.value),style:{marginBottom:"var(--spacing-sm)"}}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"var(--spacing-sm)",marginBottom:"var(--spacing-sm)"},children:[e.jsxs("select",{className:"input",value:G,onChange:t=>N(t.target.value),children:[e.jsx("option",{value:"daily",children:s.goals.daily}),e.jsx("option",{value:"weekly",children:s.goals.weekly}),e.jsx("option",{value:"monthly",children:s.goals.monthly}),e.jsx("option",{value:"custom",children:s.goals.custom})]}),e.jsx("input",{type:"number",className:"input",placeholder:s.goals.target,value:j,onChange:t=>M(t.target.value),min:"1"})]}),e.jsxs("div",{style:{display:"flex",gap:"var(--spacing-sm)"},children:[e.jsx("button",{className:"button button-primary",onClick:P,style:{flex:1},children:s.common.save}),e.jsx("button",{className:"button button-secondary",onClick:()=>k(!1),style:{flex:1},children:s.common.cancel})]})]}),g.length===0?e.jsx("div",{style:{textAlign:"center",padding:"3rem 1rem"},children:e.jsx("p",{className:"text-secondary",children:s.goals.noGoals})}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"var(--spacing-md)"},children:g.map(t=>{const r=t.current/t.target*100,a=t.current>=t.target;return e.jsxs("div",{style:{padding:"var(--spacing-md)",border:`2px solid ${a?"var(--primary)":"var(--border-color)"}`,borderRadius:"0.5rem",background:a?"var(--bg-secondary)":"transparent"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"var(--spacing-sm)"},children:[e.jsxs("div",{style:{flex:1},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[a?e.jsx(K,{size:20,color:"var(--primary)"}):e.jsx(U,{size:20}),e.jsx("h3",{style:{fontSize:"1.125rem",fontWeight:500},children:t.title})]}),e.jsxs("p",{style:{fontSize:"0.875rem",opacity:.7,marginTop:"0.25rem"},children:[s.goals[t.type]," â€¢ ",t.current,"/",t.target," ",s.poems.count]})]}),e.jsx("button",{className:"button button-secondary",onClick:()=>T(t.id),style:{padding:"0.25rem 0.5rem",fontSize:"0.75rem"},children:s.common.delete})]}),e.jsx("div",{style:{width:"100%",height:"8px",background:"var(--border-color)",borderRadius:"4px",overflow:"hidden"},children:e.jsx("div",{style:{width:`${Math.min(r,100)}%`,height:"100%",background:a?"var(--primary)":"var(--text-secondary)",transition:"width 0.3s ease"}})})]},t.id)})})]}),l==="achievements"&&e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(250px, 1fr))",gap:"var(--spacing-md)"},children:i.map(t=>{const r=t.progress>=t.maxProgress;return e.jsxs("div",{style:{padding:"var(--spacing-md)",border:`2px solid ${r?"var(--primary)":"var(--border-color)"}`,borderRadius:"0.5rem",background:r?"var(--bg-secondary)":"transparent",opacity:r?1:.6},children:[e.jsx("div",{style:{fontSize:"3rem",textAlign:"center",marginBottom:"var(--spacing-sm)",filter:r?"none":"grayscale(100%)"},children:t.icon}),e.jsx("h3",{style:{fontSize:"1rem",fontWeight:500,textAlign:"center",marginBottom:"0.25rem"},children:t.title}),e.jsx("p",{style:{fontSize:"0.75rem",opacity:.7,textAlign:"center",marginBottom:"var(--spacing-sm)"},children:t.description}),e.jsx("div",{style:{textAlign:"center",marginBottom:"0.5rem"},children:e.jsxs("span",{style:{fontSize:"0.875rem",fontWeight:500},children:[t.progress,"/",t.maxProgress]})}),e.jsx("div",{style:{width:"100%",height:"6px",background:"var(--border-color)",borderRadius:"3px",overflow:"hidden"},children:e.jsx("div",{style:{width:`${t.progress/t.maxProgress*100}%`,height:"100%",background:r?"var(--primary)":"var(--text-secondary)",transition:"width 0.3s ease"}})}),r&&t.unlockedAt&&e.jsxs("p",{style:{fontSize:"0.625rem",opacity:.5,textAlign:"center",marginTop:"0.5rem"},children:[s.achievements.unlocked," ",S(new Date(t.unlockedAt),"d MMM yyyy",{locale:A})]})]},t.id)})})]})};export{ce as default};
