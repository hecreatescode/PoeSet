import{c as P,u as O,g as F,j as n,C as k}from"./index-DQ036jwa.js";import{n as H,d as Y,t as v,c as B,m as S,a as b,s as L}from"./differenceInCalendarDays-CYIPfUpj.js";import{s as $}from"./startOfMonth-VWHcTyc_.js";import{C as A,T}from"./tag-Y_04JHHk.js";const E=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],R=P("clock",E);function Z(e,t,s){const[r,i]=H(s?.in,e,t),a=W(r,i),d=Math.abs(Y(r,i));r.setDate(r.getDate()-a*d);const l=+(W(r,i)===-a),u=a*(d-l);return u===0?0:u}function W(e,t){const s=e.getFullYear()-t.getFullYear()||e.getMonth()-t.getMonth()||e.getDate()-t.getDate()||e.getHours()-t.getHours()||e.getMinutes()-t.getMinutes()||e.getSeconds()-t.getSeconds()||e.getMilliseconds()-t.getMilliseconds();return s<0?-1:s>0?1:s}function _(e,t){return v(e,t?.in).getDay()}function q(e,t){return v(e,t?.in).getHours()}function y(e,t){const s=()=>B(t?.in,NaN),i=G(e);let a;if(i.date){const g=K(i.date,2);a=Q(g.restDateString,g.year)}if(!a||isNaN(+a))return s();const d=+a;let l=0,u;if(i.time&&(l=tt(i.time),isNaN(l)))return s();if(i.timezone){if(u=et(i.timezone),isNaN(u))return s()}else{const g=new Date(d+l),m=v(0,t?.in);return m.setFullYear(g.getUTCFullYear(),g.getUTCMonth(),g.getUTCDate()),m.setHours(g.getUTCHours(),g.getUTCMinutes(),g.getUTCSeconds(),g.getUTCMilliseconds()),m}return v(d+l+u,t?.in)}const x={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},J=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,V=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,X=/^([+-])(\d{2})(?::?(\d{2}))?$/;function G(e){const t={},s=e.split(x.dateTimeDelimiter);let r;if(s.length>2)return t;if(/:/.test(s[0])?r=s[0]:(t.date=s[0],r=s[1],x.timeZoneDelimiter.test(t.date)&&(t.date=e.split(x.timeZoneDelimiter)[0],r=e.substr(t.date.length,e.length))),r){const i=x.timezone.exec(r);i?(t.time=r.replace(i[1],""),t.timezone=i[1]):t.time=r}return t}function K(e,t){const s=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),r=e.match(s);if(!r)return{year:NaN,restDateString:""};const i=r[1]?parseInt(r[1]):null,a=r[2]?parseInt(r[2]):null;return{year:a===null?i:a*100,restDateString:e.slice((r[1]||r[2]).length)}}function Q(e,t){if(t===null)return new Date(NaN);const s=e.match(J);if(!s)return new Date(NaN);const r=!!s[4],i=h(s[1]),a=h(s[2])-1,d=h(s[3]),l=h(s[4]),u=h(s[5])-1;if(r)return at(t,l,u)?st(t,l,u):new Date(NaN);{const g=new Date(0);return!rt(t,a,d)||!it(t,i)?new Date(NaN):(g.setUTCFullYear(t,a,Math.max(i,d)),g)}}function h(e){return e?parseInt(e):1}function tt(e){const t=e.match(V);if(!t)return NaN;const s=D(t[1]),r=D(t[2]),i=D(t[3]);return ot(s,r,i)?s*S+r*b+i*1e3:NaN}function D(e){return e&&parseFloat(e.replace(",","."))||0}function et(e){if(e==="Z")return 0;const t=e.match(X);if(!t)return 0;const s=t[1]==="+"?-1:1,r=parseInt(t[2]),i=t[3]&&parseInt(t[3])||0;return ct(r,i)?s*(r*S+i*b):NaN}function st(e,t,s){const r=new Date(0);r.setUTCFullYear(e,0,4);const i=r.getUTCDay()||7,a=(t-1)*7+s+1-i;return r.setUTCDate(r.getUTCDate()+a),r}const nt=[31,null,31,30,31,30,31,31,30,31,30,31];function I(e){return e%400===0||e%4===0&&e%100!==0}function rt(e,t,s){return t>=0&&t<=11&&s>=1&&s<=(nt[t]||(I(e)?29:28))}function it(e,t){return t>=1&&t<=(I(e)?366:365)}function at(e,t,s){return t>=1&&t<=53&&s>=0&&s<=6}function ot(e,t,s){return e===24?t===0&&s===0:s>=0&&s<60&&t>=0&&t<60&&e>=0&&e<25}function ct(e,t){return t>=0&&t<=59}const lt=e=>{if(e.length===0)return{totalPoems:0,poemsThisWeek:0,poemsThisMonth:0,averageLength:0,mostUsedTags:[],writingStreak:0,mostProductiveDay:"Brak danych",mostProductiveHour:0};const t=new Date,s=L(t,{weekStartsOn:1}),r=$(t),i=e.filter(o=>y(o.date)>=s).length,a=e.filter(o=>y(o.date)>=r).length,d=e.reduce((o,c)=>o+c.content.length,0),l=Math.round(d/e.length),u={};e.forEach(o=>{o.tags.forEach(c=>{u[c]=(u[c]||0)+1})});const g=Object.entries(u).map(([o,c])=>({tag:o,count:c})).sort((o,c)=>c.count-o.count).slice(0,5),m=e.map(o=>o.date.split("T")[0]).filter((o,c,p)=>p.indexOf(o)===c).sort().reverse();let w=0;const C=t.toISOString().split("T")[0];if(m.length>0){let o=new Date(C);for(const c of m){const p=new Date(c),N=Z(o,p);if(N===0||N===1)w++,o=p;else break}}const j={};e.forEach(o=>{const c=_(y(o.date));j[c]=(j[c]||0)+1});const z=Object.entries(j).sort((o,c)=>c[1]-o[1])[0]?.[0],M=z?["Niedziela","Poniedziałek","Wtorek","Środa","Czwartek","Piątek","Sobota"][parseInt(z)]:"Brak danych",f={};e.forEach(o=>{const c=q(y(o.createdAt||o.date));f[c]=(f[c]||0)+1});const U=Object.entries(f).sort((o,c)=>c[1]-o[1])[0]?.[0]?parseInt(Object.entries(f).sort((o,c)=>c[1]-o[1])[0][0]):0;return{totalPoems:e.length,poemsThisWeek:i,poemsThisMonth:a,averageLength:l,mostUsedTags:g,writingStreak:w,mostProductiveDay:M,mostProductiveHour:U}},ft=()=>{const{t:e}=O(),t=F(),s=lt(t),i=(()=>{const a={},d=new Set(["i","a","w","z","na","do","po","o","to","się","że","nie","by","te","za","od","ze","przy","ale","lub","oraz","jest","są","jak","gdy","już","tylko","jeszcze","czyli","więc","może","czy","tam","tu","dla","przed","pod","przez"]);return t.forEach(l=>{(`${l.title} ${l.content}`.toLowerCase().match(/[a-ząćęłńóśźż]+/g)||[]).forEach(m=>{m.length>3&&!d.has(m)&&(a[m]=(a[m]||0)+1)})}),Object.entries(a).sort((l,u)=>u[1]-l[1]).slice(0,20).map(([l,u])=>({word:l,count:u}))})();return n.jsxs("div",{style:{maxWidth:"900px",margin:"0 auto",padding:"var(--spacing-md)"},children:[n.jsxs("header",{className:"mb-xl",style:{textAlign:"center"},children:[n.jsx("h1",{style:{fontSize:"clamp(1.5rem, 5vw, 2rem)",marginBottom:"0.5rem",fontWeight:300},children:e.statistics.title}),n.jsx("p",{className:"text-secondary",style:{fontSize:"clamp(0.875rem, 2.5vw, 1rem)"},children:e.statistics.subtitle})]}),n.jsxs("div",{children:[i.length>0&&n.jsxs("div",{className:"card",style:{cursor:"default"},children:[n.jsxs("h3",{style:{marginBottom:"var(--spacing-md)",fontWeight:500,display:"flex",alignItems:"center",gap:"var(--spacing-sm)"},children:[n.jsx(k,{size:20}),"Najczęściej używane słowa"]}),n.jsx("div",{style:{width:"100%",overflowX:"auto",paddingBottom:"1rem"},children:n.jsxs("svg",{width:Math.max(400,i.length*40),height:"220",children:[i.map((a,d)=>{const l=a.count/i[0].count*160,u=getComputedStyle(document.body).getPropertyValue("--accent-color")||"#2196f3";return n.jsxs("g",{children:[n.jsx("rect",{x:30+d*35,y:180-l,width:"28",height:l,fill:u.trim(),rx:"6",style:{filter:"drop-shadow(0 2px 6px rgba(0,0,0,0.08))"}}),n.jsx("text",{x:44+d*35,y:195,textAnchor:"middle",fontSize:"12",fill:"var(--text-secondary)",style:{fontFamily:"inherit"},children:a.word}),n.jsx("text",{x:44+d*35,y:180-l-8,textAnchor:"middle",fontSize:"12",fill:"var(--text-primary)",style:{fontWeight:600,fontFamily:"inherit"},children:a.count})]},a.word)}),n.jsx("line",{x1:"20",y1:"0",x2:"20",y2:"180",stroke:"#ccc",strokeWidth:"1"}),n.jsx("line",{x1:"20",y1:"180",x2:Math.max(400,i.length*40),y2:"180",stroke:"#ccc",strokeWidth:"1"})]})})]}),n.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"var(--spacing-lg)"},children:[n.jsxs("div",{className:"card",style:{cursor:"default"},children:[n.jsxs("h3",{style:{marginBottom:"var(--spacing-md)",fontWeight:500,display:"flex",alignItems:"center",gap:"var(--spacing-sm)"},children:[n.jsx(A,{size:20}),e.statistics.mostProductiveDay]}),n.jsx("p",{style:{fontSize:"1.5rem",fontWeight:300},children:s.mostProductiveDay==="Brak danych"?e.statistics.noData:s.mostProductiveDay})]}),n.jsxs("div",{className:"card",style:{cursor:"default"},children:[n.jsxs("h3",{style:{marginBottom:"var(--spacing-md)",fontWeight:500,display:"flex",alignItems:"center",gap:"var(--spacing-sm)"},children:[n.jsx(R,{size:20}),e.statistics.mostProductiveHour]}),n.jsxs("p",{style:{fontSize:"1.5rem",fontWeight:300},children:[s.mostProductiveHour,":00 - ",s.mostProductiveHour+1,":00"]})]}),n.jsxs("div",{className:"card",style:{cursor:"default"},children:[n.jsxs("h3",{style:{marginBottom:"var(--spacing-md)",fontWeight:500,display:"flex",alignItems:"center",gap:"var(--spacing-sm)"},children:[n.jsx(k,{size:20}),e.statistics.averageLength]}),n.jsxs("p",{style:{fontSize:"1.5rem",fontWeight:300},children:[s.averageLength," ",e.statistics.characters]})]}),s.mostUsedTags.length>0&&n.jsxs("div",{className:"card",style:{cursor:"default"},children:[n.jsxs("h3",{style:{marginBottom:"var(--spacing-md)",fontWeight:500,display:"flex",alignItems:"center",gap:"var(--spacing-sm)"},children:[n.jsx(T,{size:20}),e.statistics.popularTags]}),n.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"var(--spacing-md)"},children:s.mostUsedTags.map((a,d)=>n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"var(--spacing-md)"},children:[n.jsxs("span",{style:{fontSize:"1.5rem",fontWeight:300,minWidth:"2rem",color:"var(--light-text-secondary)"},children:[d+1,"."]}),n.jsx("div",{style:{flex:1},children:n.jsxs("div",{style:{height:"2rem",background:"var(--light-border)",borderRadius:"var(--radius-sm)",position:"relative",overflow:"hidden"},children:[n.jsx("div",{style:{position:"absolute",top:0,left:0,height:"100%",width:`${a.count/s.mostUsedTags[0].count*100}%`,background:"var(--light-accent)",transition:"width var(--transition-normal)"}}),n.jsx("span",{style:{position:"absolute",top:"50%",left:"var(--spacing-md)",transform:"translateY(-50%)",fontWeight:500,color:"white",mixBlendMode:"difference"},children:a.tag})]})}),n.jsx("span",{style:{fontWeight:500,minWidth:"3rem",textAlign:"right"},children:a.count})]},a.tag))})]}),i.length>0&&n.jsxs("div",{className:"card",style:{cursor:"default"},children:[n.jsxs("h3",{style:{marginBottom:"var(--spacing-md)",fontWeight:500,display:"flex",alignItems:"center",gap:"var(--spacing-sm)"},children:[n.jsx(T,{size:20}),"Najczęściej używane słowa"]}),n.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"var(--spacing-xs)"},children:i.map((a,d)=>n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"var(--spacing-md)"},children:[n.jsx("div",{style:{flex:1,position:"relative",minHeight:"2rem"},children:n.jsxs("div",{style:{position:"relative",height:"2rem",borderRadius:"var(--radius-sm)",overflow:"hidden"},children:[n.jsx("div",{style:{position:"absolute",top:0,left:0,height:"100%",width:`${a.count/i[0].count*100}%`,background:`hsl(${200-d*5}, 70%, 50%)`,transition:"width var(--transition-normal)"}}),n.jsx("span",{style:{position:"absolute",top:"50%",left:"var(--spacing-md)",transform:"translateY(-50%)",fontWeight:500,zIndex:1},children:a.word})]})}),n.jsx("span",{style:{fontWeight:500,minWidth:"3rem",textAlign:"right"},children:a.count})]},a.word))})]})]})]})]})};export{ft as default};
