import{c as y,r as l,j as e,u as N,b as P,n as v,e as D}from"./index-CClFHwME.js";import{P as H,M as I}from"./PoemEditor-CxYKt_g5.js";import{X as u}from"./x-BhaqKP45.js";import{T as E}from"./trash-2-DZnQV3wk.js";import{f as d,p as c}from"./pl-BLL9vXq1.js";const _=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],W=y("copy",_);const B=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],T=y("history",B);const $=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],A=y("share-2",$);const L=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],q=y("square-pen",L),V=({isOpen:t,onClose:a,title:r,children:m,footer:o})=>(l.useEffect(()=>{const i=p=>{p.key==="Escape"&&t&&a()};return document.addEventListener("keydown",i),()=>document.removeEventListener("keydown",i)},[t,a]),l.useEffect(()=>(t?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[t]),t?e.jsx("div",{className:"modal-overlay",onClick:a,children:e.jsxs("div",{className:"modal-content",onClick:i=>i.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h2",{children:r}),e.jsx("button",{className:"modal-close",onClick:a,"aria-label":"Close",children:e.jsx(u,{size:24})})]}),e.jsx("div",{className:"modal-body",children:m}),o&&e.jsx("div",{className:"modal-footer",children:o})]})}):null),G=({poem:t,onClose:a,onUpdate:r})=>{const[m,o]=l.useState(!1),[i,p]=l.useState(!1),[j,g]=l.useState(!1),[f,h]=l.useState(!1),{t:n}=N(),b=P(),w=()=>{g(!0)},k=()=>{D(t.id),r(),a()},z=()=>{const s=`${t.title}

${t.content}

${d(new Date(t.date),"d MMMM yyyy",{locale:c})}`;navigator.share?navigator.share({title:t.title||"Wiersz",text:s}):(navigator.clipboard.writeText(s),alert("Wiersz skopiowany do schowka!"))},S=()=>{o(!1),r()},M=()=>{const s=new Date().toISOString(),x={...t,id:`poem_${Date.now()}`,title:`${t.title} (kopia)`,createdAt:s,updatedAt:s,date:s,versions:void 0};v(x),r(),alert("Wiersz zduplikowany!")};return m?e.jsx(H,{poem:t,onSave:S,onClose:()=>o(!1)}):e.jsxs("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"var(--light-bg)",zIndex:1e3,display:"flex",flexDirection:"column"},onClick:()=>p(!i),children:[i&&e.jsxs("div",{style:{padding:"var(--spacing-md)",borderBottom:"1px solid var(--light-border)",display:"flex",justifyContent:"space-between",alignItems:"center",background:"var(--light-bg)"},children:[e.jsx("button",{className:"button button-secondary",onClick:s=>{s.stopPropagation(),a()},style:{padding:"0.5rem"},children:e.jsx(u,{size:20})}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[t.versions&&t.versions.length>0&&e.jsx("button",{className:"button button-secondary",onClick:s=>{s.stopPropagation(),h(!f)},style:{padding:"0.5rem"},title:n.viewer.versionHistory,children:e.jsx(T,{size:20})}),e.jsx("button",{className:"button button-secondary",onClick:s=>{s.stopPropagation(),z()},style:{padding:"0.5rem"},children:e.jsx(A,{size:20})}),e.jsx("button",{className:"button button-secondary",onClick:s=>{s.stopPropagation(),M()},style:{padding:"0.5rem"},title:"Duplikuj wiersz",children:e.jsx(W,{size:20})}),e.jsx("button",{className:"button button-secondary",onClick:s=>{s.stopPropagation(),o(!0)},style:{padding:"0.5rem"},children:e.jsx(q,{size:20})}),e.jsx("button",{className:"button button-secondary",onClick:s=>{s.stopPropagation(),w()},style:{padding:"0.5rem",color:"#dc2626"},children:e.jsx(E,{size:20})})]})]}),e.jsxs("div",{style:{flex:1,padding:"var(--spacing-xl)",overflow:"auto",display:"flex",flexDirection:"column",justifyContent:"center",maxWidth:"700px",margin:"0 auto",width:"100%"},children:[t.title&&e.jsx("h1",{className:"font-serif",style:{fontSize:"2rem",marginBottom:"var(--spacing-lg)",fontWeight:400,textAlign:"center"},children:t.title}),b.enableMarkdown?e.jsx("div",{className:"font-serif markdown-preview",style:{fontSize:"1.125rem",lineHeight:1.8,marginBottom:"var(--spacing-xl)"},dangerouslySetInnerHTML:{__html:I.parse(t.content)}}):e.jsx("p",{className:"font-serif",style:{fontSize:"1.125rem",lineHeight:1.8,whiteSpace:"pre-wrap",marginBottom:"var(--spacing-xl)"},children:t.content}),e.jsxs("div",{style:{marginTop:"auto"},children:[e.jsx("p",{className:"text-secondary",style:{fontSize:"0.875rem",textAlign:"center",marginBottom:"var(--spacing-md)"},children:d(new Date(t.date),"d MMMM yyyy",{locale:c})}),t.tags.length>0&&e.jsx("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap",justifyContent:"center"},children:t.tags.map(s=>e.jsx("span",{style:{fontSize:"0.75rem",padding:"0.25rem 0.75rem",borderRadius:"var(--radius-full)",background:"var(--light-border)"},children:s},s))})]})]}),f&&t.versions&&t.versions.length>0&&e.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,background:"var(--bg-primary)",zIndex:10,overflowY:"auto",padding:"var(--spacing-lg)"},children:e.jsxs("div",{style:{maxWidth:"800px",margin:"0 auto"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"var(--spacing-lg)"},children:[e.jsx("h2",{style:{fontSize:"1.5rem",fontWeight:300},children:n.viewer.versionHistory}),e.jsx("button",{className:"button button-secondary",onClick:()=>h(!1),style:{padding:"0.5rem"},children:e.jsx(u,{size:20})})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"var(--spacing-md)"},children:[e.jsxs("div",{style:{padding:"var(--spacing-md)",border:"2px solid var(--primary)",borderRadius:"0.5rem",background:"var(--bg-secondary)"},children:[e.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"var(--spacing-sm)"},children:e.jsxs("div",{children:[e.jsx("span",{style:{fontSize:"0.875rem",fontWeight:600,color:"var(--primary)"},children:n.viewer.currentVersion}),e.jsx("p",{style:{fontSize:"0.75rem",opacity:.6,marginTop:"0.25rem"},children:d(new Date(t.updatedAt),"d MMM yyyy, HH:mm",{locale:c})})]})}),e.jsx("p",{style:{fontSize:"0.875rem",whiteSpace:"pre-wrap",lineHeight:1.6},children:t.content})]}),t.versions.map((s,x)=>e.jsxs("div",{style:{padding:"var(--spacing-md)",border:"1px solid var(--border-color)",borderRadius:"0.5rem",background:"var(--bg-secondary)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"var(--spacing-sm)"},children:[e.jsxs("div",{children:[e.jsxs("span",{style:{fontSize:"0.875rem",opacity:.8},children:[n.viewer.version," ",t.versions.length-x]}),e.jsx("p",{style:{fontSize:"0.75rem",opacity:.6,marginTop:"0.25rem"},children:d(new Date(s.timestamp),"d MMM yyyy, HH:mm",{locale:c})})]}),e.jsx("button",{className:"button button-secondary",onClick:()=>{const C={...t,content:s.content,updatedAt:new Date().toISOString()};v(C),r(),h(!1)},style:{fontSize:"0.75rem",padding:"0.375rem 0.75rem"},children:n.viewer.restore})]}),e.jsx("p",{style:{fontSize:"0.875rem",whiteSpace:"pre-wrap",lineHeight:1.6},children:s.content})]},s.id))]})]})}),e.jsx(V,{isOpen:j,onClose:()=>g(!1),title:n.editor.deletePoem||"Usuń wiersz",footer:e.jsxs("div",{style:{display:"flex",gap:"var(--spacing-sm)",justifyContent:"flex-end"},children:[e.jsx("button",{className:"button button-secondary",onClick:()=>g(!1),children:n.editor.cancel||"Anuluj"}),e.jsx("button",{className:"button button-primary",onClick:k,style:{background:"var(--danger)",borderColor:"var(--danger)"},children:n.editor.delete||"Usuń"})]}),children:e.jsx("p",{children:n.editor.deleteConfirm||"Czy na pewno chcesz usunąć ten wiersz? Ta operacja jest nieodwracalna."})})]})};export{V as M,G as P,q as S};
