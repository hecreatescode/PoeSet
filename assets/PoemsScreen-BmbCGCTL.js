import{c as M,r as o,j as e,u as G,g as C,b as X,d as J,e as ee,f as te}from"./index-BG7hoHTH.js";import{P as se}from"./PoemViewer-Q2Weipqk.js";import{u as ne,M as oe}from"./PoemEditor-BUhSX_1k.js";import{T as le}from"./trash-2-CdcvXxsp.js";import{f as ae,p as ie,e as re}from"./pl-BLL9vXq1.js";import"./x-awpyHCEC.js";import"./index-wdLQ6AW8.js";import"./tag-CLT6nv-1.js";import"./plus-DqrXJBr-.js";import"./differenceInCalendarDays-CYIPfUpj.js";const ce=[["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"M9 13h6",key:"1uhe8q"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],de=M("folder-plus",ce);const me=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],pe=M("funnel",me);const ue=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],he=M("search",ue);const ge=[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],xe=M("square-check-big",ge),ye=({content:s,children:N,maxWidth:P=300,delay:j=500})=>{const[y,a]=o.useState(!1),[b,f]=o.useState({top:0,left:0}),u=o.useRef(null),d=o.useRef(null),i=o.useRef(null),B=()=>{i.current=setTimeout(()=>{const g=d.current?.getBoundingClientRect();g&&(f({top:g.bottom+window.scrollY+8,left:g.left+window.scrollX+g.width/2}),a(!0))},j)},h=()=>{i.current&&clearTimeout(i.current),a(!1)};return o.useEffect(()=>()=>{i.current&&clearTimeout(i.current)},[]),e.jsxs("div",{ref:d,className:"tooltip-container",onMouseEnter:B,onMouseLeave:h,children:[N,y&&e.jsx("div",{ref:u,className:"tooltip",style:{top:`${b.top}px`,left:`${b.left}px`,maxWidth:`${P}px`},children:s})]})},A=20,Ne=()=>{const{t:s,language:N}=G(),P=N==="pl"?ie:re,[j,y]=o.useState(()=>C()),[a,b]=o.useState(""),[f,u]=o.useState(null),[d,i]=o.useState("newest"),B=X(),[h,g]=o.useState(A),[R,H]=o.useState(!1),[v,D]=o.useState(""),[S,I]=o.useState(""),[w,E]=o.useState(""),[k,_]=o.useState(""),[z,$]=o.useState(""),[m,T]=o.useState(!1),[l,x]=o.useState(new Set),[W,L]=o.useState(!1),F=o.useRef(null);ne([{key:"f",ctrlKey:!0,callback:()=>F.current?.focus(),description:"Search (Ctrl+F)"},{key:"Escape",callback:()=>f&&u(null),description:"Close (Esc)"}]);const p=o.useMemo(()=>{let t=[...j];return a&&(t=t.filter(n=>n.title.toLowerCase().includes(a.toLowerCase())||n.content.toLowerCase().includes(a.toLowerCase())||n.tags.some(c=>c.toLowerCase().includes(a.toLowerCase())))),v&&(t=t.filter(n=>n.date>=v)),S&&(t=t.filter(n=>n.date<=S+"T23:59:59")),w&&(t=t.filter(n=>n.content.length>=parseInt(w))),k&&(t=t.filter(n=>n.content.length<=parseInt(k))),z&&(t=t.filter(n=>n.mood===z)),t.sort((n,c)=>{switch(d){case"newest":return new Date(c.date).getTime()-new Date(n.date).getTime();case"oldest":return new Date(n.date).getTime()-new Date(c.date).getTime();case"alphabetical":return n.title.localeCompare(c.title);default:return 0}}),t},[j,a,d,v,S,w,k,z]),r=o.useMemo(()=>p.slice(0,h),[p,h]),V=h<p.length,q=()=>{const t=C();y(t),u(null)},U=()=>{T(!m),x(new Set)},O=t=>{const n=new Set(l);n.has(t)?n.delete(t):n.add(t),x(n)},Z=()=>{l.size===r.length?x(new Set):x(new Set(r.map(t=>t.id)))},K=()=>{if(l.size===0)return;const t=l.size;if(confirm(`Czy na pewno chcesz usunąć ${t} ${t===1?"wiersz":"wierszy"}?`)){l.forEach(c=>ee(c));const n=C();y(n),x(new Set),T(!1)}},Q=t=>{l.forEach(c=>{te(c,t)});const n=C();y(n),x(new Set),L(!1),T(!1)},Y=()=>{g(t=>t+A)};return e.jsxs("div",{style:{padding:"var(--spacing-lg)"},children:[e.jsxs("header",{style:{marginBottom:"var(--spacing-xl)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.5rem"},children:[e.jsx("h1",{style:{fontSize:"2rem",margin:0,fontWeight:300},children:s.poems.title}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[m&&l.size>0&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{className:"button button-secondary",onClick:()=>L(!0),style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(de,{size:18}),"Dodaj do kolekcji (",l.size,")"]}),e.jsxs("button",{className:"button button-secondary",onClick:K,style:{display:"flex",alignItems:"center",gap:"0.5rem",color:"#ef4444"},children:[e.jsx(le,{size:18}),"Usuń (",l.size,")"]})]}),e.jsxs("button",{className:`button ${m?"button-primary":"button-secondary"}`,onClick:U,style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(xe,{size:18}),m?"Anuluj":"Zaznacz"]})]})]}),e.jsx("p",{className:"text-secondary",children:s.poems.subtitle})]}),e.jsxs("div",{style:{marginBottom:"var(--spacing-lg)"},children:[e.jsxs("div",{style:{position:"relative",marginBottom:"var(--spacing-md)"},children:[e.jsx(he,{size:20,style:{position:"absolute",left:"1rem",top:"50%",transform:"translateY(-50%)",opacity:.5}}),e.jsx("input",{ref:F,type:"text",className:"input",placeholder:s.poems.search,value:a,onChange:t=>b(t.target.value),style:{paddingLeft:"3rem"}})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:[e.jsx("button",{className:`button ${d==="newest"?"button-primary":"button-secondary"}`,onClick:()=>i("newest"),style:{fontSize:"0.875rem",padding:"0.5rem 1rem"},children:s.poems.newest}),e.jsx("button",{className:`button ${d==="oldest"?"button-primary":"button-secondary"}`,onClick:()=>i("oldest"),style:{fontSize:"0.875rem",padding:"0.5rem 1rem"},children:s.poems.oldest}),e.jsx("button",{className:`button ${d==="alphabetical"?"button-primary":"button-secondary"}`,onClick:()=>i("alphabetical"),style:{fontSize:"0.875rem",padding:"0.5rem 1rem"},children:s.poems.alphabetical}),e.jsxs("button",{className:"button button-secondary",onClick:()=>H(!R),style:{fontSize:"0.875rem",padding:"0.5rem 1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(pe,{size:16}),s.poems.filters]})]}),R&&e.jsxs("div",{style:{marginTop:"var(--spacing-md)",padding:"var(--spacing-md)",border:"1px solid var(--border-color)",borderRadius:"0.5rem",display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"var(--spacing-md)"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"0.875rem",marginBottom:"0.5rem",opacity:.7},children:s.poems.dateFrom}),e.jsx("input",{type:"date",className:"input",value:v,onChange:t=>D(t.target.value),style:{fontSize:"0.875rem"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"0.875rem",marginBottom:"0.5rem",opacity:.7},children:s.poems.dateTo}),e.jsx("input",{type:"date",className:"input",value:S,onChange:t=>I(t.target.value),style:{fontSize:"0.875rem"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"0.875rem",marginBottom:"0.5rem",opacity:.7},children:s.poems.minLength}),e.jsx("input",{type:"number",className:"input",placeholder:"0",value:w,onChange:t=>E(t.target.value),style:{fontSize:"0.875rem"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"0.875rem",marginBottom:"0.5rem",opacity:.7},children:s.poems.maxLength}),e.jsx("input",{type:"number",className:"input",placeholder:"∞",value:k,onChange:t=>_(t.target.value),style:{fontSize:"0.875rem"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"0.875rem",marginBottom:"0.5rem",opacity:.7},children:s.poems.mood}),e.jsxs("select",{className:"input",value:z,onChange:t=>$(t.target.value),style:{fontSize:"0.875rem"},children:[e.jsx("option",{value:"",children:s.poems.allMoods}),e.jsx("option",{value:"happy",children:s.mood.happy}),e.jsx("option",{value:"sad",children:s.mood.sad}),e.jsx("option",{value:"neutral",children:s.mood.neutral}),e.jsx("option",{value:"inspired",children:s.mood.inspired}),e.jsx("option",{value:"melancholic",children:s.mood.melancholic}),e.jsx("option",{value:"excited",children:s.mood.excited}),e.jsx("option",{value:"calm",children:s.mood.calm}),e.jsx("option",{value:"anxious",children:s.mood.anxious})]})]}),e.jsx("div",{style:{display:"flex",alignItems:"flex-end"},children:e.jsx("button",{className:"button button-secondary",onClick:()=>{D(""),I(""),E(""),_(""),$("")},style:{fontSize:"0.875rem",width:"100%"},children:s.poems.clearFilters})})]})]}),p.length===0?e.jsx("div",{style:{textAlign:"center",padding:"3rem 1rem"},children:e.jsx("p",{className:"text-secondary",children:a?s.poems.noResults:s.poems.noPoems})}):e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"text-secondary mb-md",style:{fontSize:"0.875rem"},children:[p.length," ",p.length===1?s.poems.countSingular:s.poems.count,r.length<p.length&&e.jsxs("span",{children:[" (",s.poems.shown," ",r.length,")"]})]}),m&&r.length>0&&e.jsx("div",{style:{marginBottom:"0.5rem"},children:e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:l.size===r.length&&r.length>0,onChange:Z,style:{width:"18px",height:"18px"}}),e.jsxs("span",{style:{fontSize:"0.9rem",fontWeight:500},children:["Zaznacz wszystkie (",r.length,")"]})]})}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"var(--spacing-md)"},children:r.map(t=>e.jsx(ye,{content:e.jsxs("div",{className:"tooltip-content-preview",children:[e.jsx("strong",{children:t.title||s.editor.untitled}),e.jsx("br",{}),t.content.substring(0,200),t.content.length>200&&"..."]}),delay:800,children:e.jsxs("div",{className:"card",onClick:()=>!m&&u(t),style:{cursor:m?"default":"pointer",display:"flex",gap:"1rem"},children:[m&&e.jsx("div",{style:{paddingTop:"0.25rem"},children:e.jsx("input",{type:"checkbox",checked:l.has(t.id),onChange:()=>O(t.id),onClick:n=>n.stopPropagation(),style:{width:"20px",height:"20px",cursor:"pointer"}})}),e.jsxs("div",{style:{flex:1},children:[e.jsx("h3",{style:{marginBottom:"0.5rem",fontWeight:500},children:t.title||s.editor.untitled}),e.jsx("p",{className:"text-secondary",style:{fontSize:"0.875rem",marginBottom:"1rem"},children:ae(new Date(t.date),"d MMMM yyyy",{locale:P})}),B.enableMarkdown?e.jsx("div",{className:"markdown-preview",style:{lineHeight:1.6,maxHeight:"100px",overflow:"hidden",textOverflow:"ellipsis"},dangerouslySetInnerHTML:{__html:oe.parse(t.content.substring(0,200)+(t.content.length>200?"...":""))}}):e.jsx("p",{style:{whiteSpace:"pre-wrap",lineHeight:1.6,maxHeight:"100px",overflow:"hidden",textOverflow:"ellipsis"},children:t.content}),t.tags.length>0&&e.jsxs("div",{style:{marginTop:"1rem",display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:[t.tags.slice(0,3).map(n=>e.jsx("span",{style:{fontSize:"0.75rem",padding:"0.25rem 0.75rem",borderRadius:"var(--radius-full)",background:"var(--light-border)"},children:n},n)),t.tags.length>3&&e.jsxs("span",{style:{fontSize:"0.75rem",padding:"0.25rem 0.75rem",borderRadius:"var(--radius-full)",background:"var(--light-border)"},children:["+",t.tags.length-3]})]})]})]})},t.id))}),V&&e.jsxs("button",{className:"button button-secondary",onClick:Y,style:{marginTop:"var(--spacing-lg)",width:"100%"},children:[s.poems.loadMore," (",p.length-h," ",s.poems.remaining,")"]})]}),f&&e.jsx(se,{poem:f,onClose:()=>u(null),onUpdate:q}),W&&e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:e.jsxs("div",{style:{background:"var(--bg-primary)",padding:"2rem",borderRadius:"1rem",maxWidth:"400px",width:"90%"},children:[e.jsx("h2",{style:{marginBottom:"1rem",fontSize:"1.25rem"},children:"Dodaj do kolekcji"}),e.jsxs("p",{style:{marginBottom:"1rem",color:"var(--text-secondary)",fontSize:"0.9rem"},children:["Wybierz kolekcję, do której chcesz dodać zaznaczone wiersze (",l.size,")"]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem",marginBottom:"1rem"},children:J().map(t=>e.jsx("button",{className:"button button-secondary",onClick:()=>Q(t.id),style:{width:"100%",justifyContent:"flex-start"},children:t.name},t.id))}),e.jsx("button",{className:"button button-secondary",onClick:()=>L(!1),style:{width:"100%"},children:"Anuluj"})]})})]})};export{Ne as default};
