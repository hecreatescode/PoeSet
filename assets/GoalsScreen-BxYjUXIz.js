import{c as b,r as d,u as R,x as $,g as C,y as H,z as E,R as I,j as e,A as W,B as F}from"./index-cIcf2WGv.js";import{t as G,g as L,s as Y,f as S,p as A}from"./pl-Bq6CFB2J.js";import{P as q}from"./plus-EOzF2S2F.js";const V=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],J=b("circle-check",V);const K=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Q=b("circle",K);const U=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],X=b("target",U);const Z=[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]],ee=b("trophy",Z);function te(m,c){const a=G(m,c?.in),y=a.getMonth();return a.setFullYear(a.getFullYear(),y+1,0),a.setHours(23,59,59,999),a}function se(m,c){const a=G(m,c?.in);return a.setDate(1),a.setHours(0,0,0,0),a}function re(m,c){const a=L(),y=c?.weekStartsOn??c?.locale?.options?.weekStartsOn??a.weekStartsOn??a.locale?.options?.weekStartsOn??0,l=G(m,c?.in),h=l.getDay(),f=(h<y?-7:0)+6-(h-y);return l.setDate(l.getDate()+f),l.setHours(23,59,59,999),l}const ie=()=>{const[m,c]=d.useState([]),[a,y]=d.useState([]),[l,h]=d.useState("goals"),[f,k]=d.useState(!1),[N,M]=d.useState("weekly"),[j,_]=d.useState("7"),[w,z]=d.useState(""),{t:s}=R(),D=d.useCallback(()=>{const t=$(),r=C(),n=new Date,i=t.map(o=>{let p=0;const O=new Date(o.startDate);switch(o.type){case"daily":p=r.filter(g=>S(new Date(g.date),"yyyy-MM-dd")===S(n,"yyyy-MM-dd")).length;break;case"weekly":{const g=Y(n,{locale:A}),x=re(n,{locale:A});p=r.filter(u=>{const v=new Date(u.date);return v>=g&&v<=x}).length;break}case"monthly":{const g=se(n),x=te(n);p=r.filter(u=>{const v=new Date(u.date);return v>=g&&v<=x}).length;break}case"custom":{const g=o.endDate?new Date(o.endDate):n;p=r.filter(x=>{const u=new Date(x.date);return u>=O&&u<=g}).length;break}}return{...o,current:p}});c(i)},[]),B=d.useCallback(()=>{const t=H();t.length===0&&[{id:"first_poem",title:s.achievements.firstPoem,description:s.achievements.firstPoemDesc,icon:"âœ’ï¸",progress:0,maxProgress:1},{id:"streak_7",title:s.achievements.streak7,description:s.achievements.streak7Desc,icon:"ðŸ”¥",progress:0,maxProgress:7},{id:"poems_50",title:s.achievements.poems50,description:s.achievements.poems50Desc,icon:"ðŸ“š",progress:0,maxProgress:50},{id:"poems_100",title:s.achievements.poems100,description:s.achievements.poems100Desc,icon:"ðŸ†",progress:0,maxProgress:100}].forEach(o=>E(o));const r=C(),n=t.map(i=>{let o=i.progress;i.id==="first_poem"&&r.length>0?o=1:i.id==="poems_50"?o=Math.min(r.length,50):i.id==="poems_100"&&(o=Math.min(r.length,100));const p=o>=i.maxProgress;return{...i,progress:o,unlockedAt:p&&!i.unlockedAt?new Date().toISOString():i.unlockedAt}});y(n)},[s]);I.useEffect(()=>{D(),B()},[]);const P=()=>{if(!w.trim()||!j)return;const t=new Date().toISOString(),r={id:`goal_${Date.now()}`,type:N,target:parseInt(j),current:0,startDate:t,title:w.trim()};W(r),D(),k(!1),z(""),_("7"),M("weekly")},T=t=>{F(t),D()};return e.jsxs("div",{style:{padding:"var(--spacing-lg)"},children:[e.jsxs("header",{style:{marginBottom:"var(--spacing-xl)"},children:[e.jsx("h1",{style:{fontSize:"2rem",marginBottom:"0.5rem",fontWeight:300},children:s.goals.title}),e.jsx("p",{className:"text-secondary",children:s.goals.subtitle})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"var(--spacing-lg)",borderBottom:"1px solid var(--border-color)"},children:[e.jsxs("button",{className:`button ${l==="goals"?"button-primary":"button-secondary"}`,onClick:()=>h("goals"),style:{borderRadius:"0.5rem 0.5rem 0 0",borderBottom:"none"},children:[e.jsx(X,{size:18}),s.goals.title]}),e.jsxs("button",{className:`button ${l==="achievements"?"button-primary":"button-secondary"}`,onClick:()=>h("achievements"),style:{borderRadius:"0.5rem 0.5rem 0 0",borderBottom:"none"},children:[e.jsx(ee,{size:18}),s.achievements.title]})]}),l==="goals"&&e.jsxs("div",{children:[e.jsxs("button",{className:"button button-primary",onClick:()=>k(!f),style:{marginBottom:"var(--spacing-md)"},children:[e.jsx(q,{size:20}),s.goals.newGoal]}),f&&e.jsxs("div",{style:{padding:"var(--spacing-md)",border:"1px solid var(--border-color)",borderRadius:"0.5rem",marginBottom:"var(--spacing-md)",background:"var(--bg-secondary)"},children:[e.jsx("input",{type:"text",className:"input",placeholder:s.goals.title,value:w,onChange:t=>z(t.target.value),style:{marginBottom:"var(--spacing-sm)"}}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"var(--spacing-sm)",marginBottom:"var(--spacing-sm)"},children:[e.jsxs("select",{className:"input",value:N,onChange:t=>M(t.target.value),children:[e.jsx("option",{value:"daily",children:s.goals.daily}),e.jsx("option",{value:"weekly",children:s.goals.weekly}),e.jsx("option",{value:"monthly",children:s.goals.monthly}),e.jsx("option",{value:"custom",children:s.goals.custom})]}),e.jsx("input",{type:"number",className:"input",placeholder:s.goals.target,value:j,onChange:t=>_(t.target.value),min:"1"})]}),e.jsxs("div",{style:{display:"flex",gap:"var(--spacing-sm)"},children:[e.jsx("button",{className:"button button-primary",onClick:P,style:{flex:1},children:s.common.save}),e.jsx("button",{className:"button button-secondary",onClick:()=>k(!1),style:{flex:1},children:s.common.cancel})]})]}),m.length===0?e.jsx("div",{style:{textAlign:"center",padding:"3rem 1rem"},children:e.jsx("p",{className:"text-secondary",children:s.goals.noGoals})}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"var(--spacing-md)"},children:m.map(t=>{const r=t.current/t.target*100,n=t.current>=t.target;return e.jsxs("div",{style:{padding:"var(--spacing-md)",border:`2px solid ${n?"var(--primary)":"var(--border-color)"}`,borderRadius:"0.5rem",background:n?"var(--bg-secondary)":"transparent"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"var(--spacing-sm)"},children:[e.jsxs("div",{style:{flex:1},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[n?e.jsx(J,{size:20,color:"var(--primary)"}):e.jsx(Q,{size:20}),e.jsx("h3",{style:{fontSize:"1.125rem",fontWeight:500},children:t.title})]}),e.jsxs("p",{style:{fontSize:"0.875rem",opacity:.7,marginTop:"0.25rem"},children:[s.goals[t.type]," â€¢ ",t.current,"/",t.target," ",s.poems.count]})]}),e.jsx("button",{className:"button button-secondary",onClick:()=>T(t.id),style:{padding:"0.25rem 0.5rem",fontSize:"0.75rem"},children:s.common.delete})]}),e.jsx("div",{style:{width:"100%",height:"8px",background:"var(--border-color)",borderRadius:"4px",overflow:"hidden"},children:e.jsx("div",{style:{width:`${Math.min(r,100)}%`,height:"100%",background:n?"var(--primary)":"var(--text-secondary)",transition:"width 0.3s ease"}})})]},t.id)})})]}),l==="achievements"&&e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(250px, 1fr))",gap:"var(--spacing-md)"},children:a.map(t=>{const r=t.progress>=t.maxProgress;return e.jsxs("div",{style:{padding:"var(--spacing-md)",border:`2px solid ${r?"var(--primary)":"var(--border-color)"}`,borderRadius:"0.5rem",background:r?"var(--bg-secondary)":"transparent",opacity:r?1:.6},children:[e.jsx("div",{style:{fontSize:"3rem",textAlign:"center",marginBottom:"var(--spacing-sm)",filter:r?"none":"grayscale(100%)"},children:t.icon}),e.jsx("h3",{style:{fontSize:"1rem",fontWeight:500,textAlign:"center",marginBottom:"0.25rem"},children:t.title}),e.jsx("p",{style:{fontSize:"0.75rem",opacity:.7,textAlign:"center",marginBottom:"var(--spacing-sm)"},children:t.description}),e.jsx("div",{style:{textAlign:"center",marginBottom:"0.5rem"},children:e.jsxs("span",{style:{fontSize:"0.875rem",fontWeight:500},children:[t.progress,"/",t.maxProgress]})}),e.jsx("div",{style:{width:"100%",height:"6px",background:"var(--border-color)",borderRadius:"3px",overflow:"hidden"},children:e.jsx("div",{style:{width:`${t.progress/t.maxProgress*100}%`,height:"100%",background:r?"var(--primary)":"var(--text-secondary)",transition:"width 0.3s ease"}})}),r&&t.unlockedAt&&e.jsxs("p",{style:{fontSize:"0.625rem",opacity:.5,textAlign:"center",marginTop:"0.5rem"},children:[s.achievements.unlocked," ",S(new Date(t.unlockedAt),"d MMM yyyy",{locale:A})]})]},t.id)})})]})};export{ie as default};
