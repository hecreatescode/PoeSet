import{r as n,g as w,j as e,b as N,d as k,e as f,F as B}from"./index-DUjVVPir.js";import{X as C,S as P,f as b,p as v}from"./PoemEditor-DwOHfkiM.js";import{P as D,S as I,T as W}from"./PoemViewer-CVI7FHxY.js";import{D as $}from"./download-BMf-9n3-.js";import{P as O}from"./plus-BmsTvjMa.js";import"./differenceInCalendarDays-CdXAuEcn.js";const z=["#2c2c2c","#dc2626","#ea580c","#d97706","#65a30d","#16a34a","#0891b2","#2563eb","#7c3aed","#c026d3","#db2777","#8d6e63"],S=({collection:t,onSave:h,onClose:c})=>{const[r,m]=n.useState(t?.name||""),[o,d]=n.useState(t?.description||""),[a,y]=n.useState(t?.color||z[0]),[p,u]=n.useState(t?.poemIds||[]),[i]=n.useState(()=>w()),l=()=>{if(!r.trim())return;const s={id:t?.id||`collection_${Date.now()}`,name:r.trim(),description:o.trim(),color:a,poemIds:p,createdAt:t?.createdAt||new Date().toISOString()};N(s),h()},x=s=>{u(g=>g.includes(s)?g.filter(j=>j!==s):[...g,s])};return e.jsxs("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"var(--light-bg)",zIndex:1e3,display:"flex",flexDirection:"column"},children:[e.jsxs("div",{style:{padding:"var(--spacing-md)",borderBottom:"1px solid var(--light-border)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("button",{className:"button button-secondary",onClick:c,style:{padding:"0.5rem"},children:e.jsx(C,{size:20})}),e.jsxs("button",{className:"button button-primary",onClick:l,disabled:!r.trim(),children:[e.jsx(P,{size:20}),"Zapisz"]})]}),e.jsxs("div",{style:{flex:1,padding:"var(--spacing-xl)",overflow:"auto"},children:[e.jsx("input",{type:"text",className:"input",placeholder:"Nazwa zbioru",value:r,onChange:s=>m(s.target.value),style:{fontSize:"1.5rem",fontWeight:500,marginBottom:"var(--spacing-lg)"}}),e.jsx("textarea",{className:"input",placeholder:"Opis (opcjonalny)",value:o,onChange:s=>d(s.target.value),style:{minHeight:"100px",marginBottom:"var(--spacing-lg)"}}),e.jsxs("div",{style:{marginBottom:"var(--spacing-xl)"},children:[e.jsx("label",{style:{display:"block",marginBottom:"var(--spacing-sm)",fontWeight:500},children:"Kolor zbioru"}),e.jsx("div",{style:{display:"flex",gap:"var(--spacing-sm)",flexWrap:"wrap"},children:z.map(s=>e.jsx("button",{onClick:()=>y(s),style:{width:"40px",height:"40px",borderRadius:"var(--radius-md)",background:s,border:a===s?"3px solid var(--light-accent)":"1px solid var(--light-border)",cursor:"pointer",transition:"all var(--transition-fast)"}},s))})]}),e.jsxs("div",{children:[e.jsxs("label",{style:{display:"block",marginBottom:"var(--spacing-md)",fontWeight:500},children:["Wybierz wiersze (",p.length,")"]}),i.length===0?e.jsx("p",{className:"text-secondary",children:"Nie masz jeszcze żadnych wierszy."}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"var(--spacing-sm)"},children:i.map(s=>e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"var(--spacing-md)",padding:"var(--spacing-md)",border:"1px solid var(--light-border)",borderRadius:"var(--radius-md)",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:p.includes(s.id),onChange:()=>x(s.id),style:{width:"18px",height:"18px"}}),e.jsxs("div",{style:{flex:1},children:[e.jsx("p",{style:{fontWeight:500},children:s.title||"Bez tytułu"}),e.jsxs("p",{className:"text-secondary",style:{fontSize:"0.875rem"},children:[s.content.substring(0,50),"..."]})]})]},s.id))})]})]})]})},E=({collection:t,onClose:h,onUpdate:c})=>{const[r,m]=n.useState(!1),[o,d]=n.useState(null),a=n.useMemo(()=>w().filter(x=>t.poemIds.includes(x.id)),[t.poemIds]),y=()=>{window.confirm("Czy na pewno chcesz usunąć ten zbiór?")&&(k(t.id),c(),h())},p=()=>{const l=`${t.name}
${t.description?t.description+`
`:""}
${"=".repeat(50)}

`+a.map(j=>`${j.title||"Bez tytułu"}

${j.content}

${b(new Date(j.date),"d MMMM yyyy",{locale:v})}

---

`).join(""),x=new Blob([l],{type:"text/plain"}),s=URL.createObjectURL(x),g=document.createElement("a");g.href=s,g.download=`${t.name}.txt`,g.click()},u=()=>{m(!1),c()},i=()=>{c(),d(null)};return r?e.jsx(S,{collection:t,onSave:u,onClose:()=>m(!1)}):o?e.jsx(D,{poem:o,onClose:()=>d(null),onUpdate:i}):e.jsxs("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"var(--light-bg)",zIndex:1e3,display:"flex",flexDirection:"column"},children:[e.jsxs("div",{style:{padding:"var(--spacing-md)",borderBottom:"1px solid var(--light-border)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("button",{className:"button button-secondary",onClick:h,style:{padding:"0.5rem"},children:e.jsx(C,{size:20})}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsx("button",{className:"button button-secondary",onClick:p,style:{padding:"0.5rem"},children:e.jsx($,{size:20})}),e.jsx("button",{className:"button button-secondary",onClick:()=>m(!0),style:{padding:"0.5rem"},children:e.jsx(I,{size:20})}),e.jsx("button",{className:"button button-secondary",onClick:y,style:{padding:"0.5rem",color:"#dc2626"},children:e.jsx(W,{size:20})})]})]}),e.jsxs("div",{style:{flex:1,padding:"var(--spacing-xl)",overflow:"auto"},children:[e.jsxs("div",{style:{borderLeft:`4px solid ${t.color}`,paddingLeft:"var(--spacing-lg)",marginBottom:"var(--spacing-xl)"},children:[e.jsx("h1",{style:{fontSize:"2rem",marginBottom:"0.5rem",fontWeight:400},children:t.name}),t.description&&e.jsx("p",{className:"text-secondary",style:{fontSize:"1rem"},children:t.description}),e.jsxs("p",{className:"text-secondary",style:{fontSize:"0.875rem",marginTop:"var(--spacing-md)"},children:[a.length," ",a.length===1?"wiersz":"wierszy"]})]}),a.length===0?e.jsx("div",{style:{textAlign:"center",padding:"3rem 1rem"},children:e.jsx("p",{className:"text-secondary",children:"Ten zbiór nie zawiera jeszcze żadnych wierszy."})}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"var(--spacing-md)"},children:a.map(l=>e.jsxs("div",{className:"card",onClick:()=>d(l),children:[e.jsx("h3",{style:{marginBottom:"0.5rem",fontWeight:500},children:l.title||"Bez tytułu"}),e.jsx("p",{className:"text-secondary",style:{fontSize:"0.875rem",marginBottom:"1rem"},children:b(new Date(l.date),"d MMMM yyyy",{locale:v})}),e.jsx("p",{style:{whiteSpace:"pre-wrap",lineHeight:1.6,maxHeight:"100px",overflow:"hidden",textOverflow:"ellipsis"},children:l.content})]},l.id))})]})]})},H=()=>{const[t,h]=n.useState(f()),[c,r]=n.useState(!1),[m,o]=n.useState(null),[d,a]=n.useState(null),y=()=>{const i=f();h(i)},p=()=>{y(),r(!1),o(null)},u=i=>t.find(x=>x.id===i)?.poemIds.length||0;return e.jsxs("div",{children:[e.jsxs("header",{className:"mb-xl",children:[e.jsx("h1",{style:{fontSize:"2rem",marginBottom:"0.5rem",fontWeight:300},children:"Zbiory"}),e.jsx("p",{className:"text-secondary",children:"Twoje tomiki poetyckie"})]}),e.jsxs("button",{className:"button button-primary mb-lg",onClick:()=>{o(null),r(!0)},children:[e.jsx(O,{size:20}),"Nowy zbiór"]}),t.length===0?e.jsxs("div",{style:{textAlign:"center",padding:"3rem 1rem"},children:[e.jsx(B,{size:48,style:{opacity:.3,margin:"0 auto 1rem"}}),e.jsx("p",{className:"text-secondary",children:"Nie masz jeszcze żadnych zbiorów."}),e.jsx("p",{className:"text-secondary",style:{marginTop:"0.5rem"},children:"Stwórz tomik, aby grupować swoje wiersze."})]}):e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(250px, 1fr))",gap:"var(--spacing-md)"},children:t.map(i=>e.jsxs("div",{className:"card",onClick:()=>a(i),style:{borderLeft:`4px solid ${i.color}`},children:[e.jsx("h3",{style:{marginBottom:"0.5rem",fontWeight:500},children:i.name}),i.description&&e.jsx("p",{className:"text-secondary",style:{fontSize:"0.875rem",marginBottom:"1rem",overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical"},children:i.description}),e.jsxs("p",{className:"text-secondary",style:{fontSize:"0.75rem"},children:[u(i.id)," ",u(i.id)===1?"wiersz":"wierszy"]})]},i.id))}),c&&e.jsx(S,{collection:m||void 0,onSave:p,onClose:()=>{r(!1),o(null)}}),d&&e.jsx(E,{collection:d,onClose:()=>a(null),onUpdate:y})]})};export{H as default};
